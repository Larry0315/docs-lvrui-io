<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"docs.lvrui.io","root":"/","scheme":"Muse","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. &quot;å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº&quot;, åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ&quot;.">
<meta property="og:type" content="website">
<meta property="og:title" content="Polar Snow Documentation">
<meta property="og:url" content="https://docs.lvrui.io/page/21/index.html">
<meta property="og:site_name" content="Polar Snow Documentation">
<meta property="og:description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. &quot;å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº&quot;, åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ&quot;.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="æåœ°ç‘é›ª">
<meta property="article:tag" content="Kubernetes">
<meta property="article:tag" content="k8s">
<meta property="article:tag" content="etcd">
<meta property="article:tag" content="golang">
<meta property="article:tag" content="python">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://docs.lvrui.io/page/21/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Polar Snow Documentation</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?963aa068438aaf077b5ce5d3b8d51c95";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Polar Snow Documentation</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">èŠ±æœ‰é‡å¼€æ—¥ äººæ— å†å°‘å¹´</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>æ ‡ç­¾<span class="badge">372</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†ç±»<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>å½’æ¡£<span class="badge">284</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Larry0315" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/20/ESXi6-0%E8%B0%83%E7%94%A8%E5%AF%B9%E8%B1%A1datastoreSystem%E5%A4%B1%E8%B4%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/20/ESXi6-0%E8%B0%83%E7%94%A8%E5%AF%B9%E8%B1%A1datastoreSystem%E5%A4%B1%E8%B4%A5/" class="post-title-link" itemprop="url">ESXi6.0è°ƒç”¨å¯¹è±¡datastoreSystemå¤±è´¥</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-20 14:05:11" itemprop="dateCreated datePublished" datetime="2016-07-20T14:05:11+08:00">2016-07-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/20/ESXi6-0%E8%B0%83%E7%94%A8%E5%AF%B9%E8%B1%A1datastoreSystem%E5%A4%B1%E8%B4%A5/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/20/ESXi6-0è°ƒç”¨å¯¹è±¡datastoreSystemå¤±è´¥/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>VMware vSphere Clientä¸Šæ·»åŠ å­˜å‚¨æ—¶æ˜¾ç¤ºï¼šåœ¨ ESXiâ€œ192.168.59.59â€ä¸Šè°ƒç”¨å¯¹è±¡ â€œdatastoresystemâ€çš„â€œHostDatastoreSystem.QueryVmfsDatastoreCreateOptionsâ€ å¤±è´¥</p>
</blockquote>
<ul>
<li>åœ¨è¯¥ä¸»æœºçš„<code>é…ç½®</code>â€”&gt;<code>å®‰å…¨é…ç½®æ–‡ä»¶</code>ä¸­ï¼Œå¼€å¯<code>SSH</code>å’Œ<code>ESXi Shell</code>æœåŠ¡</li>
<li>ssh <a href="mailto:root@192.168.59.59">root@192.168.59.59</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&gt; ls /vmfs/devices/disks</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:1</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:2</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:3</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:5</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:6</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:7</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:8</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:9</span><br><span class="line">naa.6782bcb0635695001f21a2451bd15e08</span><br><span class="line">naa.6782bcb0635695001f21a2451bd15e08:1</span><br><span class="line">naa.6782bcb0635695001f21a2451bd15e08:2</span><br><span class="line">naa.6782bcb0635695001f21a25f1d533c53</span><br><span class="line">naa.6782bcb0635695001f21a25f1d533c53:1</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:1</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:2</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:3</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:5</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:6</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:7</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:8</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:9</span><br><span class="line">vml.02000000006782bcb0635695001f21a2451bd15e08504552432036</span><br><span class="line">vml.02000000006782bcb0635695001f21a2451bd15e08504552432036:1</span><br><span class="line">vml.02000000006782bcb0635695001f21a2451bd15e08504552432036:2</span><br><span class="line">vml.02000000006782bcb0635695001f21a25f1d533c53504552432036</span><br><span class="line">vml.02000000006782bcb0635695001f21a25f1d533c53504552432036:1</span><br></pre></td></tr></table></figure>

<ul>
<li>vSphere Clientä¸­æ‰¾åˆ°æŠ¥é”™çš„é‚£å—ç£ç›˜åå­—ï¼Œæˆ‘è¿™é‡Œæ˜¯<code>naa.6782bcb0635695001f21a2451bd15e08</code></li>
<li>å°†è¯¥å—ç£ç›˜é‡æ–°åˆ†åŒº</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; partedUtil mklabel /dev/disks/naa.6782bcb0635695001f21a2451bd15e08 gpt</span><br></pre></td></tr></table></figure>

<p>æˆ‘è¿™é‡Œçš„ç£ç›˜å®¹é‡ä¸º2Tï¼Œè¿™é‡Œä½¿ç”¨gptåˆ†åŒºè¡¨ï¼Œå¦‚æœå®¹é‡ä¸æ˜¯å¾ˆå¤§ï¼Œå¯ä»¥å†™<code>msdos</code> ä½¿ç”¨MBRåˆ†åŒºè¡¨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&gt; ls /vmfs/devices/disks</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:1</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:2</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:3</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:5</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:6</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:7</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:8</span><br><span class="line">naa.6782bcb0635695001f1f261018908d00:9</span><br><span class="line">naa.6782bcb0635695001f21a2451bd15e08</span><br><span class="line">naa.6782bcb0635695001f21a25f1d533c53</span><br><span class="line">naa.6782bcb0635695001f21a25f1d533c53:1</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:1</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:2</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:3</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:5</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:6</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:7</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:8</span><br><span class="line">vml.02000000006782bcb0635695001f1f261018908d00504552432036:9</span><br><span class="line">vml.02000000006782bcb0635695001f21a2451bd15e08504552432036</span><br><span class="line">vml.02000000006782bcb0635695001f21a25f1d533c53504552432036</span><br><span class="line">vml.02000000006782bcb0635695001f21a25f1d533c53504552432036:1</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡æ·»åŠ ç£ç›˜ï¼ŒæˆåŠŸï¼</p>
<hr>
<p>å‚è€ƒæ–‡æ¡£ï¼š <a href="https://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;externalId=2076191" target="_blank" rel="noopener">https://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;externalId=2076191</a></p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/20/Python%E4%B8%AD%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%E9%98%9F%E5%88%97queue%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/20/Python%E4%B8%AD%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%E9%98%9F%E5%88%97queue%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">Pythonä¸­å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—queueçš„åŸºæœ¬ä½¿ç”¨</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-20 01:26:12" itemprop="dateCreated datePublished" datetime="2016-07-20T01:26:12+08:00">2016-07-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/20/Python%E4%B8%AD%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%E9%98%9F%E5%88%97queue%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/20/Pythonä¸­å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—queueçš„åŸºæœ¬ä½¿ç”¨/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>ç”Ÿæ´»ä¸­éå¸¸å¸¸è§çš„ä¸€ç§åœºæ™¯å°±æ˜¯æ’é˜Ÿï¼Œæ—©æœŸçš„é¸Ÿå„¿ğŸ¦æœ‰è™«ğŸ›åƒï¼Œè¶Šæ—©æ’é˜Ÿå°±è¶Šæ—©èƒ½åŠç†ä¸šåŠ¡ã€‚æœ¬ç¯‡æ–‡ç« ä»‹ç»Pythonä¸­çš„â€œæ’é˜Ÿç³»ç»Ÿâ€ï¼Œå…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—çš„åŸºæœ¬ä½¿ç”¨</p>
</blockquote>
<h1 id="putæ•°æ®"><a href="#putæ•°æ®" class="headerlink" title="putæ•°æ®"></a>putæ•°æ®</h1><h2 id="æ¶ˆæ¯é˜Ÿåˆ—çš„é•¿åº¦"><a href="#æ¶ˆæ¯é˜Ÿåˆ—çš„é•¿åº¦" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—çš„é•¿åº¦"></a>æ¶ˆæ¯é˜Ÿåˆ—çš„é•¿åº¦</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€å¤šæ¥æ”¶10ä¸ªæ•°æ®</span></span><br><span class="line">q = queue.Queue(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># put å‘é˜Ÿåˆ—ä¸­æ·»åŠ æ•°æ®</span></span><br><span class="line">q.put(<span class="number">15</span>)</span><br><span class="line">q.put(<span class="number">59</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰é˜Ÿåˆ—é•¿åº¦</span></span><br><span class="line">print(q.qsize())</span><br><span class="line"></span><br><span class="line"><span class="comment"># å–å‡ºæœ€å‰é¢çš„ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">print(q.get())</span><br></pre></td></tr></table></figure>

<h2 id="è¶…æ—¶æ—¶é—´"><a href="#è¶…æ—¶æ—¶é—´" class="headerlink" title="è¶…æ—¶æ—¶é—´"></a>è¶…æ—¶æ—¶é—´</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€å¤šæ¥æ”¶10ä¸ªæ•°æ®</span></span><br><span class="line">q = queue.Queue(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># put å‘é˜Ÿåˆ—ä¸­æ·»åŠ æ•°æ®</span></span><br><span class="line">q.put(<span class="number">15</span>)</span><br><span class="line">q.put(<span class="number">59</span>)</span><br><span class="line">print(q.qsize())</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¶…æ—¶æ—¶é—´ä¸º2ç§’</span></span><br><span class="line">q.put(<span class="string">'PolarSnow'</span>, timeout=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰é˜Ÿåˆ—é•¿åº¦</span></span><br><span class="line">print(q.qsize())</span><br><span class="line"></span><br><span class="line"><span class="comment"># å–å‡ºæœ€å‰é¢çš„ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">print(q.get())</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line"><span class="number">2</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"/Users/lvrui/PycharmProjects/untitled/10/temp.py"</span>, line <span class="number">157</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    q.put(<span class="string">'PolarSnow'</span>, timeout=<span class="number">2</span>)</span><br><span class="line">  File <span class="string">"/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/queue.py"</span>, line <span class="number">141</span>, <span class="keyword">in</span> put</span><br><span class="line">    <span class="keyword">raise</span> Full</span><br><span class="line">queue.Full</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦è®¾ç½®ä¸º2ï¼Œå½“ç¬¬ä¸‰ä¸ªæ•°æ®å‘é‡Œé¢æ’å…¥æ—¶ï¼Œæœ€å¤šç­‰å¾…ä¸¤ç§’ï¼Œä¸¤ç§’åè¿˜æ²¡æœ‰è¿›å…¥åˆ°é˜Ÿåˆ—ä¸­å°±æŠ¥é”™</p>
<h2 id="è®¾ç½®é˜Ÿåˆ—ä¸é˜»å¡"><a href="#è®¾ç½®é˜Ÿåˆ—ä¸é˜»å¡" class="headerlink" title="è®¾ç½®é˜Ÿåˆ—ä¸é˜»å¡"></a>è®¾ç½®é˜Ÿåˆ—ä¸é˜»å¡</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€å¤šæ¥æ”¶10ä¸ªæ•°æ®</span></span><br><span class="line">q = queue.Queue(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># put å‘é˜Ÿåˆ—ä¸­æ·»åŠ æ•°æ®</span></span><br><span class="line">q.put(<span class="number">15</span>)</span><br><span class="line">q.put(<span class="number">59</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®é˜Ÿåˆ—ä¸é˜»å¡(å½“é˜Ÿåˆ—æ»¡çš„æ—¶å€™å†æ’å…¥æ•°æ®,ç›´æ¥æŠ¥é”™)</span></span><br><span class="line">q.put(<span class="string">'PolarSnow'</span>, block=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰é˜Ÿåˆ—é•¿åº¦</span></span><br><span class="line">print(q.qsize())</span><br><span class="line"></span><br><span class="line"><span class="comment"># å–å‡ºæœ€å‰é¢çš„ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">print(q.get())</span><br></pre></td></tr></table></figure>

<p>é»˜è®¤ç¨‹åºä¼šé˜»å¡ï¼Œç­‰å¾…æ–°çš„å€¼æ’å…¥åˆ°é˜Ÿåˆ—å½“ä¸­ï¼Œä½¿ç”¨äº†<code>block=False</code>å‚æ•°åï¼Œå¼ºåˆ¶è®¾ç½®ä¸ºä¸é˜»å¡ï¼Œä¸€æ—¦è¶…å‡ºé˜Ÿåˆ—é•¿åº¦ï¼Œç«‹å³æŠ›å‡ºå¼‚å¸¸</p>
<h1 id="getæ•°æ®"><a href="#getæ•°æ®" class="headerlink" title="getæ•°æ®"></a>getæ•°æ®</h1><h2 id="è®¾ç½®è¶…æ—¶æ—¶é—´"><a href="#è®¾ç½®è¶…æ—¶æ—¶é—´" class="headerlink" title="è®¾ç½®è¶…æ—¶æ—¶é—´"></a>è®¾ç½®è¶…æ—¶æ—¶é—´</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">q = queue.Queue(<span class="number">2</span>)</span><br><span class="line">q.put(<span class="number">15</span>)</span><br><span class="line">q.put(<span class="number">59</span>)</span><br><span class="line"></span><br><span class="line">print(q.qsize())</span><br><span class="line">print(q.get())</span><br><span class="line">print(q.get())</span><br><span class="line">print(q.get(timeout=<span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<p>å½“å–å€¼çš„æ¬¡æ•°å¤§äºé˜Ÿåˆ—çš„é•¿åº¦çš„æ—¶å€™å°±ä¼šäº§ç”Ÿé˜»å¡ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´æ„ä¸ºæœ€å¤šç­‰å¾…xç§’ï¼Œé˜Ÿåˆ—ä¸­å†æ²¡æœ‰æ•°æ®ï¼Œå°±æŠ›å‡ºå¼‚å¸¸</p>
<h2 id="è®¾ç½®ä¸é˜»å¡"><a href="#è®¾ç½®ä¸é˜»å¡" class="headerlink" title="è®¾ç½®ä¸é˜»å¡"></a>è®¾ç½®ä¸é˜»å¡</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">q = queue.Queue(<span class="number">2</span>)</span><br><span class="line">q.put(<span class="number">15</span>)</span><br><span class="line">q.put(<span class="number">59</span>)</span><br><span class="line"></span><br><span class="line">print(q.qsize())</span><br><span class="line">print(q.get())</span><br><span class="line">print(q.get())</span><br><span class="line">print(q.get(block=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>

<p>è·å–é˜Ÿåˆ—çš„æ¬¡æ•°å¤§äºé˜Ÿåˆ—é•¿åº¦æ—¶ï¼Œé»˜è®¤ä¼šé˜»å¡ï¼Œé€šè¿‡è®¾ç½®<code>block=False</code>æ¥å®ç°éé˜»å¡ï¼Œç«‹å³æŠ›å‡ºå¼‚å¸¸</p>
<h1 id="Queueç±»"><a href="#Queueç±»" class="headerlink" title="Queueç±»"></a>Queueç±»</h1><h2 id="init"><a href="#init" class="headerlink" title="__init__"></a>__init__</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, maxsize=<span class="number">0</span>)</span>:</span></span><br><span class="line">    self.maxsize = maxsize</span><br><span class="line">    self._init(maxsize)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># mutex must be held whenever the queue is mutating.  All methods</span></span><br><span class="line">    <span class="comment"># that acquire mutex must release it before returning.  mutex</span></span><br><span class="line">    <span class="comment"># is shared between the three conditions, so acquiring and</span></span><br><span class="line">    <span class="comment"># releasing the conditions also acquires and releases mutex.</span></span><br><span class="line">    self.mutex = threading.Lock()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Notify not_empty whenever an item is added to the queue; a</span></span><br><span class="line">    <span class="comment"># thread waiting to get is notified then.</span></span><br><span class="line">    self.not_empty = threading.Condition(self.mutex)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Notify not_full whenever an item is removed from the queue;</span></span><br><span class="line">    <span class="comment"># a thread waiting to put is notified then.</span></span><br><span class="line">    self.not_full = threading.Condition(self.mutex)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Notify all_tasks_done whenever the number of unfinished tasks</span></span><br><span class="line">    <span class="comment"># drops to zero; thread waiting to join() is notified to resume</span></span><br><span class="line">    self.all_tasks_done = threading.Condition(self.mutex)</span><br><span class="line">    self.unfinished_tasks = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸ç»™è¿™ä¸ªæ„é€ æ–¹æ³•ä¼ å‚æ•°ï¼Œé˜Ÿåˆ—çš„é•¿åº¦ä¸ºæ— é™å¤§</p>
<h2 id="get"><a href="#get" class="headerlink" title="get"></a>get</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, block=True, timeout=None)</span>:</span></span><br><span class="line">    <span class="string">'''Remove and return an item from the queue.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    If optional args 'block' is true and 'timeout' is None (the default),</span></span><br><span class="line"><span class="string">    block if necessary until an item is available. If 'timeout' is</span></span><br><span class="line"><span class="string">    a non-negative number, it blocks at most 'timeout' seconds and raises</span></span><br><span class="line"><span class="string">    the Empty exception if no item was available within that time.</span></span><br><span class="line"><span class="string">    Otherwise ('block' is false), return an item if one is immediately</span></span><br><span class="line"><span class="string">    available, else raise the Empty exception ('timeout' is ignored</span></span><br><span class="line"><span class="string">    in that case).</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">with</span> self.not_empty:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> block:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self._qsize():</span><br><span class="line">                <span class="keyword">raise</span> Empty</span><br><span class="line">        <span class="keyword">elif</span> timeout <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">while</span> <span class="keyword">not</span> self._qsize():</span><br><span class="line">                self.not_empty.wait()</span><br><span class="line">        <span class="keyword">elif</span> timeout &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"'timeout' must be a non-negative number"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            endtime = time() + timeout</span><br><span class="line">            <span class="keyword">while</span> <span class="keyword">not</span> self._qsize():</span><br><span class="line">                remaining = endtime - time()</span><br><span class="line">                <span class="keyword">if</span> remaining &lt;= <span class="number">0.0</span>:</span><br><span class="line">                    <span class="keyword">raise</span> Empty</span><br><span class="line">                self.not_empty.wait(remaining)</span><br><span class="line">        item = self._get()</span><br><span class="line">        self.not_full.notify()</span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure>

<p>å‚æ•°ä¸ºæ˜¯å¦é˜»å¡å’Œè¶…æ—¶æ—¶é—´</p>
<h2 id="get-nowait"><a href="#get-nowait" class="headerlink" title="get_nowait"></a>get_nowait</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_nowait</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">'''Remove and return an item from the queue without blocking.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Only get an item if one is immediately available. Otherwise</span></span><br><span class="line"><span class="string">    raise the Empty exception.</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">return</span> self.get(block=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<p>éé˜»å¡è·å–é˜Ÿåˆ—ä¸­çš„å€¼</p>
<h2 id="put-amp-amp-put-nowait"><a href="#put-amp-amp-put-nowait" class="headerlink" title="put &amp;&amp; put_nowait"></a>put &amp;&amp; put_nowait</h2><p>ä¸<code>get &amp; get_nowait</code>åŒç†</p>
<h2 id="empty"><a href="#empty" class="headerlink" title="empty"></a>empty</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">empty</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">'''Return True if the queue is empty, False otherwise (not reliable!).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This method is likely to be removed at some point.  Use qsize() == 0</span></span><br><span class="line"><span class="string">    as a direct substitute, but be aware that either approach risks a race</span></span><br><span class="line"><span class="string">    condition where a queue can grow before the result of empty() or</span></span><br><span class="line"><span class="string">    qsize() can be used.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    To create code that needs to wait for all queued tasks to be</span></span><br><span class="line"><span class="string">    completed, the preferred technique is to use the join() method.</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">with</span> self.mutex:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> self._qsize()</span><br></pre></td></tr></table></figure>

<p>æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºè¿”å›Trueï¼Œä¸ä¸ºç©ºè¿”å›False</p>
<h2 id="full"><a href="#full" class="headerlink" title="full"></a>full</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">full</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">'''Return True if the queue is full, False otherwise (not reliable!).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This method is likely to be removed at some point.  Use qsize() &gt;= n</span></span><br><span class="line"><span class="string">    as a direct substitute, but be aware that either approach risks a race</span></span><br><span class="line"><span class="string">    condition where a queue can shrink before the result of full() or</span></span><br><span class="line"><span class="string">    qsize() can be used.</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">with</span> self.mutex:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span> &lt; self.maxsize &lt;= self._qsize()</span><br></pre></td></tr></table></figure>

<p>åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦å·²ç»æ»¡äº†</p>
<h2 id="qsize"><a href="#qsize" class="headerlink" title="qsize"></a>qsize</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">qsize</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">'''Return the approximate size of the queue (not reliable!).'''</span></span><br><span class="line">    <span class="keyword">with</span> self.mutex:</span><br><span class="line">        <span class="keyword">return</span> self._qsize()</span><br></pre></td></tr></table></figure>

<p>è¿”å›é˜Ÿåˆ—ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼ˆçœŸå®ä¸ªæ•°ï¼‰</p>
<p>æ„é€ æ–¹æ³•ä¸­å°è£…äº†<code>maxsize</code>å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨<code>å¯¹è±¡.maxsize</code>æ¥è·å–å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å€¼</p>
<h2 id="join-amp-task-done"><a href="#join-amp-task-done" class="headerlink" title="join &amp; task_done"></a>join &amp; task_done</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">q = queue.Queue(<span class="number">2</span>)</span><br><span class="line">q.put(<span class="number">15</span>)</span><br><span class="line">q.put(<span class="number">59</span>)</span><br></pre></td></tr></table></figure>

<p>ç¨‹åºæ‰§è¡Œå®Œè¿™5è¡Œä»£ç åä¼šé€€å‡ºï¼Œé€€å‡ºå‰é˜Ÿåˆ—ä¸­è¿˜æœ‰å€¼ï¼Œé€€å‡ºåè¢«æ¸…ç©º</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">q = queue.Queue(<span class="number">2</span>)</span><br><span class="line">q.put(<span class="number">15</span>)</span><br><span class="line">q.put(<span class="number">59</span>)</span><br><span class="line"></span><br><span class="line">q.join()</span><br></pre></td></tr></table></figure>

<p>ç¨‹åºä¼šä¸€ç›´å¡åœ¨ç¬¬7è¡Œï¼Œåªè¦é˜Ÿåˆ—ä¸­è¿˜æœ‰å€¼ï¼Œç¨‹åºå°±ä¸ä¼šé€€å‡º</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">q = queue.Queue(<span class="number">2</span>)</span><br><span class="line">q.put(<span class="number">15</span>)</span><br><span class="line">q.put(<span class="number">59</span>)</span><br><span class="line"></span><br><span class="line">q.get()</span><br><span class="line">q.get()</span><br><span class="line"></span><br><span class="line">q.join()</span><br></pre></td></tr></table></figure>

<p>é˜Ÿåˆ—ä¸­æ’å…¥ä¸¤ä¸ªå…ƒç´ ï¼Œåé¢å–å‡ºäº†ä¸¤ä¸ªå…ƒç´ ï¼Œæ‰§è¡Œåä½ ä¼šå‘ç°ï¼Œç¨‹åºè¿˜æ˜¯å¡åœ¨ç¬¬10è¡Œçš„é‚£ä¸ªjoinä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">q = queue.Queue(<span class="number">2</span>)</span><br><span class="line">q.put(<span class="number">15</span>)</span><br><span class="line">q.put(<span class="number">59</span>)</span><br><span class="line"></span><br><span class="line">q.get()</span><br><span class="line">q.task_done()  <span class="comment"># getå–å®Œé˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªå€¼åï¼Œä½¿ç”¨task_doneæ–¹æ³•å‘Šè¯‰é˜Ÿåˆ—ï¼Œæˆ‘å·²ç»å–å‡ºäº†ä¸€ä¸ªå€¼å¹¶å¤„ç†å®Œæ¯•</span></span><br><span class="line">q.get()</span><br><span class="line">q.task_done()</span><br><span class="line"></span><br><span class="line">q.join()</span><br></pre></td></tr></table></figure>

<p>åœ¨æ¯æ¬¡getå–å€¼ä¹‹åï¼Œè¿˜éœ€è¦åœ¨è·Ÿé˜Ÿåˆ—å£°æ˜ä¸€ä¸‹ï¼Œæˆ‘å·²ç»å–å‡ºäº†æ•°æ®å¹¶å¤„ç†å®Œæ¯•ï¼Œè¿™æ ·æ‰§è¡Œåˆ°joinä»£ç çš„æ—¶å€™æ‰ä¸ä¼šè¢«å¡ä½</p>
<h1 id="Pythonæä¾›çš„æ‰€æœ‰é˜Ÿåˆ—ç±»å‹"><a href="#Pythonæä¾›çš„æ‰€æœ‰é˜Ÿåˆ—ç±»å‹" class="headerlink" title="Pythonæä¾›çš„æ‰€æœ‰é˜Ÿåˆ—ç±»å‹"></a>Pythonæä¾›çš„æ‰€æœ‰é˜Ÿåˆ—ç±»å‹</h1><ul>
<li>å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—    queue.Queue</li>
<li>åè¿›å…ˆå‡ºé˜Ÿåˆ—    queue.LifoQueue (Queueçš„åŸºç¡€ä¸Šè¿›è¡Œçš„å°è£…)</li>
<li>ä¼˜å…ˆçº§é˜Ÿåˆ—    queue.PriorityQueue (Queueçš„åŸºç¡€ä¸Šè¿›è¡Œçš„å°è£…)</li>
<li>åŒå‘é˜Ÿåˆ— queue.deque</li>
</ul>
<h2 id="åè¿›å…ˆå‡ºé˜Ÿåˆ—"><a href="#åè¿›å…ˆå‡ºé˜Ÿåˆ—" class="headerlink" title="åè¿›å…ˆå‡ºé˜Ÿåˆ—"></a>åè¿›å…ˆå‡ºé˜Ÿåˆ—</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">q = queue.LifoQueue()</span><br><span class="line">q.put(<span class="string">'Polar'</span>)</span><br><span class="line">q.put(<span class="string">'Snow'</span>)</span><br><span class="line"></span><br><span class="line">print(q.get())</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">Snow</span><br></pre></td></tr></table></figure>

<h2 id="ä¼˜å…ˆçº§é˜Ÿåˆ—"><a href="#ä¼˜å…ˆçº§é˜Ÿåˆ—" class="headerlink" title="ä¼˜å…ˆçº§é˜Ÿåˆ—"></a>ä¼˜å…ˆçº§é˜Ÿåˆ—</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">q = queue.PriorityQueue()</span><br><span class="line">q.put((<span class="number">1</span>, <span class="string">'Snow'</span>))</span><br><span class="line">q.put((<span class="number">0</span>, <span class="string">'Polar'</span>))</span><br><span class="line"></span><br><span class="line">print(q.get())</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">Polar</span><br></pre></td></tr></table></figure>

<p>æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œæ•°å­—ç›¸åŒï¼Œå…ˆè¿›å…ˆå‡º</p>
<h2 id="åŒå‘é˜Ÿåˆ—"><a href="#åŒå‘é˜Ÿåˆ—" class="headerlink" title="åŒå‘é˜Ÿåˆ—"></a>åŒå‘é˜Ÿåˆ—</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line">q = queue.deque()</span><br><span class="line"></span><br><span class="line">q.append(<span class="string">'A'</span>)   <span class="comment"># åœ¨å³ä¾§è¿½åŠ   A</span></span><br><span class="line">q.append(<span class="string">'X'</span>)   <span class="comment"># åœ¨å³ä¾§è¿½åŠ   A X</span></span><br><span class="line">q.appendleft(<span class="string">'Z'</span>)   <span class="comment"># åœ¨å·¦ä¾§è¿½åŠ   Z A X</span></span><br><span class="line">q.appendleft(<span class="string">'V'</span>)   <span class="comment"># åœ¨å·¦ä¾§è¿½åŠ   V Z A X</span></span><br><span class="line"></span><br><span class="line">print(q.pop()) <span class="comment"># ä»å³ä¾§å–  --&gt; X</span></span><br><span class="line">print(q.popleft()) <span class="comment"># ä»å·¦ä¾§å–  --&gt; V</span></span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">X</span><br><span class="line">V</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/20/Python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84run%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/20/Python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84run%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">Pythonå¤šçº¿ç¨‹ä¸­çš„runæ–¹æ³•</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-20 00:32:24" itemprop="dateCreated datePublished" datetime="2016-07-20T00:32:24+08:00">2016-07-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/20/Python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84run%E6%96%B9%E6%B3%95/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/20/Pythonå¤šçº¿ç¨‹ä¸­çš„runæ–¹æ³•/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>Pythonä¸­çš„å¤šçº¿ç¨‹é€šè¿‡threadingæ¨¡å—æ¥å®ç°ã€‚å®ç°Pythonä¸­çš„å¤šçº¿ç¨‹æœ‰ä¸¤ç§æ–¹å¼ï¼Œæœ¬ç¯‡æ–‡ç« ä»‹ç»å¤šçº¿ç¨‹ä¸­ï¼Œrunæ–¹æ³•çš„ä½¿ç”¨</p>
</blockquote>
<p>ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»äº†å¤šçº¿ç¨‹çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼Œåœ¨æ‰§è¡ŒThreadå¯¹è±¡çš„startæ–¹æ³•ä¹‹åï¼Œå£°æ˜æŒ‡å®šçš„targetå‡½æ•°å·²ç»å°±ç»ªï¼Œå‡†å¤‡è¢«CPUè°ƒç”¨æ‰§è¡Œã€‚å½“CPUçš„æ—¶é—´ç‰‡åˆ†åˆ°è¿™ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼Œä¼šå»æ‰§è¡ŒThreadå¯¹è±¡çš„runæ–¹æ³•</p>
<p>è¿™é‡Œçš„startå’Œrunæ–¹æ³•ä¸€å®šè¦åŒºåˆ†å¼€</p>
<ul>
<li>startæ–¹æ³•æ˜¯å£°æ˜åˆ†åˆ°ä¸€ä¸ªå­çº¿ç¨‹çš„å‡½æ•°å·²ç»å°±ç»ªï¼Œç­‰å¾…è¢«CPUæ‰§è¡Œ</li>
<li>runæ–¹æ³•æ˜¯æ‰§è¡Œåˆ°è¿™ä¸ªå­çº¿ç¨‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨çš„æ–¹æ³•</li>
</ul>
<p>æ‹¿ä¸Šä¸€ç¯‡å¤šçº¿ç¨‹åŸºæœ¬ä½¿ç”¨æ–‡ç« ä¸­çš„ä¾‹å­ğŸŒ°ä¸ºä¾‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(arg)</span>:</span></span><br><span class="line">    print(<span class="string">'func start'</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(arg)</span><br><span class="line">    print(<span class="string">'func end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹</span></span><br><span class="line"><span class="comment"># target æŒ‡å®šè®©çº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line">t = threading.Thread(target=func, args=(<span class="string">'PolarSnow'</span>,))</span><br><span class="line">t.setDaemon(<span class="literal">True</span>) <span class="comment"># é»˜è®¤ä¸ºFalse</span></span><br><span class="line">t.start()</span><br><span class="line">t.join(<span class="number">1</span>) <span class="comment"># ä¸»çº¿ç¨‹åœåœ¨è¿™é‡Œ</span></span><br><span class="line">print(<span class="string">'main end'</span>)</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">func start</span><br><span class="line">main end</span><br></pre></td></tr></table></figure>

<p><code>t = threading.Thread(target=func, args=(&#39;PolarSnow&#39;,))</code>å®ä¾‹åŒ–äº†ä¸€ä¸ªThreadå¯¹è±¡ï¼Œæ‰§è¡Œäº†Threadç±»çš„æ„é€ æ–¹æ³•ï¼Œæ„é€ æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, group=None, target=None, name=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                 args=<span class="params">()</span>, kwargs=None, *, daemon=None)</span>:</span></span><br><span class="line">        <span class="string">"""This constructor should always be called with keyword arguments. Arguments are:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        *group* should be None; reserved for future extension when a ThreadGroup</span></span><br><span class="line"><span class="string">        class is implemented.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        *target* is the callable object to be invoked by the run()</span></span><br><span class="line"><span class="string">        method. Defaults to None, meaning nothing is called.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        *name* is the thread name. By default, a unique name is constructed of</span></span><br><span class="line"><span class="string">        the form "Thread-N" where N is a small decimal number.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        *args* is the argument tuple for the target invocation. Defaults to ().</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        *kwargs* is a dictionary of keyword arguments for the target</span></span><br><span class="line"><span class="string">        invocation. Defaults to &#123;&#125;.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        If a subclass overrides the constructor, it must make sure to invoke</span></span><br><span class="line"><span class="string">        the base class constructor (Thread.__init__()) before doing anything</span></span><br><span class="line"><span class="string">        else to the thread.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">assert</span> group <span class="keyword">is</span> <span class="literal">None</span>, <span class="string">"group argument must be None for now"</span></span><br><span class="line">        <span class="keyword">if</span> kwargs <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            kwargs = &#123;&#125;</span><br><span class="line">        self._target = target</span><br><span class="line">        self._name = str(name <span class="keyword">or</span> _newname())</span><br><span class="line">        self._args = args</span><br><span class="line">        self._kwargs = kwargs</span><br><span class="line">        <span class="keyword">if</span> daemon <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self._daemonic = daemon</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self._daemonic = current_thread().daemon</span><br><span class="line">        self._ident = <span class="literal">None</span></span><br><span class="line">        self._tstate_lock = <span class="literal">None</span></span><br><span class="line">        self._started = Event()</span><br><span class="line">        self._is_stopped = <span class="literal">False</span></span><br><span class="line">        self._initialized = <span class="literal">True</span></span><br><span class="line">        <span class="comment"># sys.stderr is not stored in the class like</span></span><br><span class="line">        <span class="comment"># sys.exc_info since it can be changed between instances</span></span><br><span class="line">        self._stderr = _sys.stderr</span><br><span class="line">        <span class="comment"># For debugging and _after_fork()</span></span><br><span class="line">        _dangling.add(self)</span><br></pre></td></tr></table></figure>

<p>åœ¨Threadçš„æ„é€ æ–¹æ³•ä¸­ï¼Œå°è£…äº†æˆ‘ä»¬ä¼ è¿›å»çš„ä¸¤ä¸ªå‚æ•°</p>
<p>è€Œå­çº¿ç¨‹è¢«CPUè°ƒåº¦æ‰§è¡Œçš„æ—¶å€™ï¼Œè‡ªåŠ¨æ‰§è¡Œäº†Threadå¯¹è±¡ä¸­çš„runæ–¹æ³•ï¼Œrunæ–¹æ³•æºç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Method representing the thread's activity.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        You may override this method in a subclass. The standard run() method</span></span><br><span class="line"><span class="string">        invokes the callable object passed to the object's constructor as the</span></span><br><span class="line"><span class="string">        target argument, if any, with sequential and keyword arguments taken</span></span><br><span class="line"><span class="string">        from the args and kwargs arguments, respectively.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> self._target:</span><br><span class="line">                self._target(*self._args, **self._kwargs)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            <span class="comment"># Avoid a refcycle if the thread is running a function with</span></span><br><span class="line">            <span class="comment"># an argument that has a member that points to the thread.</span></span><br><span class="line">            <span class="keyword">del</span> self._target, self._args, self._kwargs</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œè¿™é‡Œ<code>self._target(*self._args, **self._kwargs)</code>å»æ‰§è¡Œäº†æˆ‘ä»¬ä¼ è¿›å»çš„å‡½æ•°åæ‰€æŒ‡å‘çš„å‡½æ•°ä½“ï¼Œç®€å•çš„è¯´ï¼Œå°±æ˜¯æŠŠtargetå‚æ•°çš„é‚£ä¸ªå‡½æ•°æ‰§è¡Œäº†ï¼Œå¹¶ä¸”å‚æ•°å°±æ˜¯æˆ‘ä»¬ä¼ é€’è¿›å»çš„é‚£äº›å‚æ•°</p>
<h1 id="è‡ªå®šä¹‰runæ–¹æ³•"><a href="#è‡ªå®šä¹‰runæ–¹æ³•" class="headerlink" title="è‡ªå®šä¹‰runæ–¹æ³•"></a>è‡ªå®šä¹‰runæ–¹æ³•</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰ä¸€ä¸ªç±»ï¼Œç»§æ‰¿threading.Thread</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># å› ä¸ºCPUæ‰§è¡Œå­çº¿ç¨‹çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æ‰§è¡ŒThreadå¯¹è±¡çš„runæ–¹æ³•</span></span><br><span class="line">	<span class="comment"># æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬é‡å†™çˆ¶ç±»çš„runæ–¹æ³•</span></span><br><span class="line">	<span class="comment"># è¿˜è®°å¾—Pythonçš„ç»§æ‰¿å…³ç³»å—ï¼Ÿself.runè¿˜æ˜¯ä»åŸç‚¹å¼€å§‹æ‰¾</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">t = MyThread() <span class="comment"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¯¹è±¡</span></span><br><span class="line">t.start()  <span class="comment"># ç­‰å¾…è¢«CPUè¿è¡Œ</span></span><br></pre></td></tr></table></figure>

<h1 id="æ¨¡æ‹ŸThreadç±»çš„åŠŸèƒ½"><a href="#æ¨¡æ‹ŸThreadç±»çš„åŠŸèƒ½" class="headerlink" title="æ¨¡æ‹ŸThreadç±»çš„åŠŸèƒ½"></a>æ¨¡æ‹ŸThreadç±»çš„åŠŸèƒ½</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é‡å†™çˆ¶ç±»çš„æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, func, args)</span>:</span></span><br><span class="line">    	<span class="comment"># å°†å‡½æ•°åå’Œå‚æ•°å°è£…åˆ°æœ¬ç±»ä¸­</span></span><br><span class="line">        self.func = func</span><br><span class="line">        self.args = args</span><br><span class="line">        <span class="comment"># ä¸ºä¿è¯ç»§æ‰¿çš„ç±»æ­£å¸¸è¿è¡Œï¼Œè¿™é‡Œéœ€è¦æ‰§è¡Œçˆ¶ç±»çš„æ„é€ æ–¹æ³•</span></span><br><span class="line">        <span class="comment"># ä½†æ˜¯æ²¡æœ‰ç»™çˆ¶ç±»çš„æ„é€ æ–¹æ³•ä¼ é€’ä»»ä½•å‚æ•°</span></span><br><span class="line">        <span class="comment"># è€Œå¯¹è±¡å¯»æ‰¾å‚æ•°æ—¶ï¼Œä¹Ÿæ˜¯æœ€å…ˆä»æœ¬ç±»ä¸­å¯»æ‰¾</span></span><br><span class="line">        super(MyThread, self).__init__()</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="comment"># æ‰§è¡Œå‚æ•°ä¸­çš„å‡½æ•°</span></span><br><span class="line">        self.func(self.args)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰ä¸€ä¸ªéœ€è¦å­çº¿ç¨‹è¿è¡Œçš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(arg)</span>:</span></span><br><span class="line">    print(arg)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨è‡ªå®šä¹‰çš„çº¿ç¨‹å¯¹è±¡æ‰§è¡Œ</span></span><br><span class="line">t = MyThread(func=f, args=<span class="number">59</span>)</span><br><span class="line">t.start()</span><br></pre></td></tr></table></figure>

<p><em>å®é™…ä½¿ç”¨ä¸­è¿˜æ˜¯æ¨èä½¿ç”¨threadingåŸç”Ÿæä¾›çš„æ–¹å¼ï¼Œè¿™é‡Œçš„runæ–¹æ³•ä»…ä¾›ç†è§£threadingçš„å†…éƒ¨æ‰§è¡Œè¿‡ç¨‹</em></p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/17/Python%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/17/Python%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">Pythonçº¿ç¨‹çš„åŸºæœ¬ä½¿ç”¨</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-17 13:11:26" itemprop="dateCreated datePublished" datetime="2016-07-17T13:11:26+08:00">2016-07-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/17/Python%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/17/Pythonçº¿ç¨‹çš„åŸºæœ¬ä½¿ç”¨/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å®ä¾‹1-start"><a href="#å®ä¾‹1-start" class="headerlink" title="å®ä¾‹1 start"></a>å®ä¾‹1 start</h1><p>åˆ›å»ºå­çº¿ç¨‹å¹¶æ‰§è¡Œçº¿ç¨‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(arg)</span>:</span></span><br><span class="line">    print(<span class="string">'func start'</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(arg)</span><br><span class="line">    print(<span class="string">'func end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹</span></span><br><span class="line"><span class="comment"># target æŒ‡å®šè®©çº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line">t = threading.Thread(target=func, args=(<span class="string">'PolarSnow'</span>,))</span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line">print(<span class="string">'main end'</span>)</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">func start</span><br><span class="line">main end</span><br><span class="line">PolarSnow</span><br><span class="line">func end</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºäº†ä¸€ä¸ªå­çº¿ç¨‹å»æ‰§è¡Œä¸€ä¸ªå‡½æ•°</p>
<p>æ‰§è¡Œè¿™ä¸ªå‡½æ•°æœ€å°‘éœ€è¦2ç§’é’Ÿï¼Œè€Œä¸»çº¿ç¨‹ç›´æ¥å»æ‰§è¡Œäº†<code>print(&#39;end&#39;)</code>ï¼Œè¯´æ˜åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸»çº¿ç¨‹ä¸ä¼šç­‰å¾…å­çº¿ç¨‹ç›´æ¥ç»“æŸå†å‘ä¸‹æ‰§è¡Œï¼Œè€Œæ˜¯ä¸»çº¿ç¨‹å…ˆå‘ä¸‹æ‰§è¡Œï¼Œå³ä½¿ä¸»çº¿ç¨‹æ‰€æœ‰ä»£ç å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œä¹Ÿä¸ä¼šé€€å‡ºç¨‹åºï¼Œè€Œæ˜¯ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹æ‰§è¡Œç»“æŸåå†é€€å‡ºç¨‹åº</p>
<h1 id="å®ä¾‹2-setDaemon"><a href="#å®ä¾‹2-setDaemon" class="headerlink" title="å®ä¾‹2 setDaemon"></a>å®ä¾‹2 setDaemon</h1><p>è®¾ç½®ä¸»çº¿ç¨‹ä¸ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(arg)</span>:</span></span><br><span class="line">    print(<span class="string">'func start'</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(arg)</span><br><span class="line">    print(<span class="string">'func end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹</span></span><br><span class="line"><span class="comment"># target æŒ‡å®šè®©çº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line">t = threading.Thread(target=func, args=(<span class="string">'PolarSnow'</span>,))</span><br><span class="line">t.setDaemon(<span class="literal">True</span>) <span class="comment"># é»˜è®¤ä¸ºFalse</span></span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line">print(<span class="string">'main end'</span>)</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">func start</span><br><span class="line">main end</span><br></pre></td></tr></table></figure>

<p>åœ¨å¯åŠ¨çº¿ç¨‹ä¹‹å‰è®¾ç½®<code>t.setDaemon(True)</code>ä¸ºTrueï¼Œæ„æ€æ˜¯ä¸»çº¿ç¨‹ä¸ä¼šç­‰å¾…æ‰€æœ‰çš„å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å†é€€å‡ºç¨‹åºï¼Œè€Œæ˜¯å½“ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œå¼ºåˆ¶é€€å‡ºç¨‹åºï¼Œä¸ç®¡å­çº¿ç¨‹æœ‰æ²¡æœ‰æ‰§è¡Œå®Œæ¯•</p>
<h1 id="å®ä¾‹3-join"><a href="#å®ä¾‹3-join" class="headerlink" title="å®ä¾‹3 join"></a>å®ä¾‹3 join</h1><p>ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œå†å‘ä¸‹æ‰§è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(arg)</span>:</span></span><br><span class="line">    print(<span class="string">'func start'</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(arg)</span><br><span class="line">    print(<span class="string">'func end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹</span></span><br><span class="line"><span class="comment"># target æŒ‡å®šè®©çº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line">t = threading.Thread(target=func, args=(<span class="string">'PolarSnow'</span>,))</span><br><span class="line">t.setDaemon(<span class="literal">True</span>) <span class="comment"># é»˜è®¤ä¸ºFalse</span></span><br><span class="line">t.start()</span><br><span class="line">t.join() <span class="comment"># ä¸»çº¿ç¨‹åœåœ¨è¿™é‡Œ</span></span><br><span class="line">print(<span class="string">'main end'</span>)</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">func start</span><br><span class="line">PolarSnow</span><br><span class="line">func end</span><br><span class="line">main end</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨äº†joinæ–¹æ³•ä¹‹åï¼Œä¸»çº¿ç¨‹ä¼šä¸€ç›´åœåœ¨joinæ–¹æ³•é‚£ä¸€è¡Œï¼Œç›´åˆ°æ‰€æœ‰çš„å­çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•åï¼Œå†ç»§ç»­å‘ä¸‹æ‰§è¡Œ</p>
<h1 id="å®ä¾‹4-join-1"><a href="#å®ä¾‹4-join-1" class="headerlink" title="å®ä¾‹4 join(1)"></a>å®ä¾‹4 join(1)</h1><p>è®¾ç½®ä¸»çº¿ç¨‹å†æ¬¡ç­‰å¾…å­çº¿ç¨‹çš„æœ€å¤§æ—¶é—´</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(arg)</span>:</span></span><br><span class="line">    print(<span class="string">'func start'</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(arg)</span><br><span class="line">    print(<span class="string">'func end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹</span></span><br><span class="line"><span class="comment"># target æŒ‡å®šè®©çº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line">t = threading.Thread(target=func, args=(<span class="string">'PolarSnow'</span>,))</span><br><span class="line">t.setDaemon(<span class="literal">True</span>) <span class="comment"># é»˜è®¤ä¸ºFalse</span></span><br><span class="line">t.start()</span><br><span class="line">t.join(<span class="number">1</span>) <span class="comment"># ä¸»çº¿ç¨‹åœåœ¨è¿™é‡Œ</span></span><br><span class="line">print(<span class="string">'main end'</span>)</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">func start</span><br><span class="line">main end</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®ä¸ºä¸»çº¿ç¨‹åœ¨<code>t.join</code>è¿™ä¸€è¡Œï¼Œ<strong>æœ€å¤š</strong>ç­‰å¾…1ç§’é’Ÿçš„æ—¶é—´ï¼Œ1ç§’é’Ÿä¹‹åï¼Œä¸ç®¡å­çº¿ç¨‹æœ‰æ²¡æœ‰æ‰§è¡Œå®Œæ¯•éƒ½ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œ</p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/17/Python%E4%B8%AD%E7%9A%84%E5%A4%9A%E8%BF%9B%E7%A8%8B%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%AE%80%E4%BB%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/17/Python%E4%B8%AD%E7%9A%84%E5%A4%9A%E8%BF%9B%E7%A8%8B%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%AE%80%E4%BB%8B/" class="post-title-link" itemprop="url">Pythonä¸­çš„å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹ç®€ä»‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-17 12:19:05" itemprop="dateCreated datePublished" datetime="2016-07-17T12:19:05+08:00">2016-07-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/17/Python%E4%B8%AD%E7%9A%84%E5%A4%9A%E8%BF%9B%E7%A8%8B%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%AE%80%E4%BB%8B/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/17/Pythonä¸­çš„å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹ç®€ä»‹/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="http://oss.20150509.cn/20160717122059.png" alt=""></p>
<p>åœ¨Pythonä¸­è§„å®šï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹ä¸­åªå¯ä»¥æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»è¢«è°ƒç”¨æ‰§è¡Œï¼ŒGILå…¨å±€è§£é‡Šå™¨é”ï¼Œå°±æ˜¯ç”¨æ¥ä¿éšœè¿™ä¸€è§„åˆ™é¡ºåˆ©è¢«æ‰§è¡Œçš„ç»„ä»¶</p>
<p>Pythonä¸­å¯ä»¥åˆ©ç”¨å¤šæ ¸CPUçš„æ˜¯å¤šè¿›ç¨‹ï¼Œå¤šä¸ªCPUå¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªè¿›ç¨‹çš„ä»»åŠ¡ï¼Œä½†æ˜¯ï¼Œæ¯ä¸ªè¿›ç¨‹ä¸­åŒä¸€æ—¶é—´åªèƒ½å¤„ç†ä¸€ä¸ªçº¿ç¨‹</p>
<p><em>IOæ“ä½œä¸å ç”¨CPU</em></p>
<ul>
<li>å¤šçº¿ç¨‹çš„åº”ç”¨åœºæ™¯ï¼šIOæ“ä½œ</li>
<li>å¤šè¿›ç¨‹çš„åº”ç”¨åœºæ™¯ï¼šè®¡ç®—æ€§æ“ä½œ</li>
</ul>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/17/socketserver%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/17/socketserver%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/" class="post-title-link" itemprop="url">socketserveræºç é˜…è¯»</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-17 00:06:04" itemprop="dateCreated datePublished" datetime="2016-07-17T00:06:04+08:00">2016-07-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/17/socketserver%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/17/socketserveræºç é˜…è¯»/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>æœ¬ç¯‡socketserveræºç é˜…è¯»ä¸»è¦ç›®çš„æ˜¯ç†Ÿæ‚‰Pythonä¸­çš„ç»§æ‰¿æ¨¡å¼</p>
</blockquote>
<h1 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(socketserver.BaseRequestHandler)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">obj = socketserver.ThreadingTCPServer((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>), MyClass)</span><br><span class="line">obj.serve_forever()</span><br></pre></td></tr></table></figure>

<h1 id="é˜…è¯»å…¥å£"><a href="#é˜…è¯»å…¥å£" class="headerlink" title="é˜…è¯»å…¥å£"></a>é˜…è¯»å…¥å£</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj = socketserver.ThreadingTCPServer((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>), MyClass)</span><br></pre></td></tr></table></figure>

<p>ä»ä»¥ä¸Šè¿™ä¸€è¡Œä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ‰§è¡Œäº†<code>ThreadingTCPServer</code>ç±»ä¸­çš„<code>__init__</code>æ–¹æ³•ï¼ˆå®ä¾‹åŒ–äº†è¿™ä¸ªç±»çš„å¯¹è±¡ï¼Œå°±ä»è¿™é‡Œä¸ºå…¥å£ç‚¹æ¥é˜…è¯»ï¼‰</p>
<h1 id="ThreadingTCPServerç±»å›¾"><a href="#ThreadingTCPServerç±»å›¾" class="headerlink" title="ThreadingTCPServerç±»å›¾"></a>ThreadingTCPServerç±»å›¾</h1><p><img src="http://20150509.oss-cn-qingdao.aliyuncs.com/20160717000559.png" alt=""></p>
<h1 id="step-by-step"><a href="#step-by-step" class="headerlink" title="step by step"></a>step by step</h1><h2 id="step-1"><a href="#step-1" class="headerlink" title="step 1"></a>step 1</h2><p>é¦–å…ˆï¼Œä»å®ä¾‹åŒ–<code>ThreadingTCPServer</code>è¿™ä¸ªç±»çš„å¯¹è±¡å¯ä»¥å¾—çŸ¥ï¼Œæ˜¯æ‰§è¡Œäº†è¿™ä¸ªå¯¹è±¡çš„<code>__init__</code>æ„é€ æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬æŸ¥çœ‹è¿™ä¸ªç±»çš„æºç å‘ç°ï¼Œåªæœ‰ä¸€ä¸ª<code>pass</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadingTCPServer</span><span class="params">(ThreadingMixIn, TCPServer)</span>:</span> <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™ä¸ªç±»ç»§æ‰¿äº†ä¸¤ä¸ªçˆ¶ç±»ï¼Œé‚£ä¹ˆå¿…ç„¶æ˜¯æ‰§è¡Œäº†çˆ¶ç±»çš„<code>__init__</code>æ–¹æ³•ã€‚åœ¨æŸ¥æ‰¾çˆ¶ç±»<code>__init__</code>æ–¹æ³•çš„æ—¶å€™ï¼Œé¦–å…ˆä»å·¦è¾¹çš„çˆ¶ç±»å¼€å§‹æŸ¥æ‰¾</p>
<h2 id="step-2"><a href="#step-2" class="headerlink" title="step 2"></a>step 2</h2><p><code>ThreadingTCPServer</code>ç»§æ‰¿çš„ç¬¬ä¸€ä¸ªçˆ¶ç±»ä¸­<code>ThreadingMixIn</code>ï¼Œæ²¡æœ‰æ‰¾åˆ°<code>__init__</code>æ„é€ æ–¹æ³•ï¼Œæ¥ç€ï¼ŒPythonä¼šå»<code>ThreadingTCPServer</code>ç»§æ‰¿çš„ç¬¬äºŒä¸ªçˆ¶ç±»æ€»å»æŸ¥æ‰¾</p>
<h2 id="step-3"><a href="#step-3" class="headerlink" title="step 3"></a>step 3</h2><p>åœ¨<code>ThreadingTCPServer</code>ç»§æ‰¿çš„ç¬¬äºŒä¸ªçˆ¶ç±»<code>TCPServer</code>æ‰¾åˆ°äº†<code>__init__</code>æ„é€ æ–¹æ³•å¹¶æ‰§è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, server_address, RequestHandlerClass, bind_and_activate=True)</span>:</span></span><br><span class="line">    <span class="string">"""Constructor.  May be extended, do not override."""</span></span><br><span class="line">    BaseServer.__init__(self, server_address, RequestHandlerClass)</span><br><span class="line">    self.socket = socket.socket(self.address_family,</span><br><span class="line">                                self.socket_type)</span><br><span class="line">    <span class="keyword">if</span> bind_and_activate:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.server_bind()</span><br><span class="line">            self.server_activate()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            self.server_close()</span><br><span class="line">            <span class="keyword">raise</span></span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™æ®µæ„é€ æ–¹æ³•ä¸­ï¼Œå‰ä¸‰ä¸ªå‚æ•°å¯¹åº”äº†ç¤ºä¾‹ä»£ç ä¸­ï¼Œåˆ›å»º<code>ThreadingTCPServer</code>å¯¹è±¡æ—¶çš„ä¸‰ä¸ªå‚æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj = socketserver.ThreadingTCPServer((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>), MyClass)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, server_address, RequestHandlerClass, bind_and_activate=True)</span>:</span></span><br></pre></td></tr></table></figure>

<ul>
<li>self â€”&gt; obj</li>
<li>server_address â€”&gt; (â€˜127.0.0.1â€™, 1559)</li>
<li>RequestHandlerClass â€”&gt; MyClass</li>
</ul>
<p>åœ¨<code>TCPServer</code>çš„æ„é€ æ–¹æ³•æ‹¿åˆ°è¿™å‡ ä¸ªå‚æ•°ä¹‹åï¼Œç´§æ¥ç€åˆè°ƒç”¨äº†çˆ¶ç±»çš„<code>__init__</code>æ„é€ æ–¹æ³•</p>
<h3 id="step-3-1"><a href="#step-3-1" class="headerlink" title="step 3.1"></a>step 3.1</h3><p>åœ¨<code>TCPServer</code>çš„çˆ¶ç±»<code>BaseServer</code>ä¸­ï¼Œ<code>__init__</code>æ„é€ æ–¹æ³•æ‰§è¡Œäº†ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, server_address, RequestHandlerClass)</span>:</span></span><br><span class="line">    <span class="string">"""Constructor.  May be extended, do not override."""</span></span><br><span class="line">    self.server_address = server_address</span><br><span class="line">    self.RequestHandlerClass = RequestHandlerClass</span><br><span class="line">    self.__is_shut_down = threading.Event()</span><br><span class="line">    self.__shutdown_request = <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºäº†ä¸¤ä¸ªå…¬æœ‰å˜é‡å’Œä¸¤ä¸ªç§æœ‰å˜é‡ï¼Œå¹¶ä¸”</p>
<ul>
<li>RequestHandlerClass â€”&gt; MyClass</li>
</ul>
<h2 id="step-4"><a href="#step-4" class="headerlink" title="step 4"></a>step 4</h2><p><code>TCPServer</code>åœ¨æ‰§è¡Œå®Œçˆ¶ç±»çš„æ„é€ æ–¹æ³•å°è£…äº†å››ä¸ªå­—æ®µåï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.socket = socket.socket(self.address_family,</span><br><span class="line">                                    self.socket_type)</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºäº†ä¸€ä¸ªsocketå¯¹è±¡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> bind_and_activate:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        self.server_bind()</span><br><span class="line">        self.server_activate()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        self.server_close()</span><br><span class="line">        <span class="keyword">raise</span></span><br></pre></td></tr></table></figure>

<h3 id="step-4-1"><a href="#step-4-1" class="headerlink" title="step 4.1"></a>step 4.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_bind</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""Called by constructor to bind the socket.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    May be overridden.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> self.allow_reuse_address:</span><br><span class="line">        self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line">    self.socket.bind(self.server_address)</span><br><span class="line">    self.server_address = self.socket.getsockname()</span><br></pre></td></tr></table></figure>

<p>ç»‘å®šäº†IPå’Œç«¯å£å·ï¼Œ<code>self.server_address</code>çš„å€¼æ˜¯åœ¨æ‰§è¡Œçˆ¶ç±»<code>BaseServer</code>çš„æ„é€ æ–¹æ³•æ—¶åˆ›å»ºçš„</p>
<h3 id="step-4-2"><a href="#step-4-2" class="headerlink" title="step 4.2"></a>step 4.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_activate</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""Called by constructor to activate the server.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    May be overridden.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    self.socket.listen(self.request_queue_size)</span><br></pre></td></tr></table></figure>

<p>ç›‘å¬socket</p>
<p>è‡³æ­¤ï¼Œ<code>TCPServer</code>ä¸­çš„<code>__init__</code>æ„é€ æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œæ„é€ æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œå°±æ„å‘³ç€ç¤ºä¾‹ä»£ç ä¸­çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj = socketserver.ThreadingTCPServer((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>), MyClass)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€å¥å°±æ‰§è¡Œå®Œæ¯•äº†</p>
<h2 id="step-5"><a href="#step-5" class="headerlink" title="step 5"></a>step 5</h2><p>æ¥ä¸‹æ¥æµ‹è¯•ä»£ç èµ°åˆ°ç¬¬10è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.serve_forever()</span><br></pre></td></tr></table></figure>

<p><code>ThreadingTCPServer</code>é¦–å…ˆåœ¨è‡ªå·±çš„ä»£ç å—ä¸­æŸ¥æ‰¾ï¼Œæ²¡æœ‰</p>
<p>æ ¹æ®ç»§æ‰¿çš„è§„åˆ™ï¼Œå†å»å·¦è¾¹çš„çˆ¶ç±»<code>ThreadingMixIn</code>ä¸­æŸ¥æ‰¾ï¼Œæ²¡æœ‰</p>
<p>ä¹‹åå†å»å³è¾¹çš„çˆ¶ç±»<code>TCPServer</code>ä¸­æŸ¥æ‰¾ï¼Œæ²¡æœ‰</p>
<p>æœ€ååœ¨<code>TCPServer</code>çš„çˆ¶ç±»<code>BaseServer</code>ä¸­æ‰¾åˆ°äº†<code>serve_forever</code>æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">serve_forever</span><span class="params">(self, poll_interval=<span class="number">0.5</span>)</span>:</span></span><br><span class="line">    <span class="string">"""Handle one request at a time until shutdown.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Polls for shutdown every poll_interval seconds. Ignores</span></span><br><span class="line"><span class="string">    self.timeout. If you need to do periodic tasks, do them in</span></span><br><span class="line"><span class="string">    another thread.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    self.__is_shut_down.clear()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># <span class="doctag">XXX:</span> Consider using another file descriptor or connecting to the</span></span><br><span class="line">        <span class="comment"># socket to wake this up instead of polling. Polling reduces our</span></span><br><span class="line">        <span class="comment"># responsiveness to a shutdown request and wastes cpu at all other</span></span><br><span class="line">        <span class="comment"># times.</span></span><br><span class="line">        <span class="keyword">with</span> _ServerSelector() <span class="keyword">as</span> selector:</span><br><span class="line">            selector.register(self, selectors.EVENT_READ)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> <span class="keyword">not</span> self.__shutdown_request:</span><br><span class="line">                ready = selector.select(poll_interval)  <span class="comment"># IOå¤šè·¯å¤ç”¨</span></span><br><span class="line">                <span class="keyword">if</span> ready:  <span class="comment"># å¦‚æœæœ‰æ–°çš„å®¢æˆ·ç«¯è¿æ¥ï¼Œreadyå°±ä¼šæœ‰å€¼</span></span><br><span class="line">                    self._handle_request_noblock()</span><br><span class="line"></span><br><span class="line">                self.service_actions()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        self.__shutdown_request = <span class="literal">False</span></span><br><span class="line">        self.__is_shut_down.set()</span><br></pre></td></tr></table></figure>

<h3 id="step-5-1"><a href="#step-5-1" class="headerlink" title="step 5.1"></a>step 5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ready = selector.select(poll_interval)</span><br></pre></td></tr></table></figure>

<p>IOå¤šè·¯å¤ç”¨ï¼Œè¿™é‡Œæ²¡æœ‰ä½¿ç”¨selfæ¥è°ƒï¼Œè€Œæ˜¯ä½¿ç”¨selectorå¯¹è±¡æ¥è°ƒselectæ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">select</span><span class="params">(self, timeout=None)</span>:</span></span><br><span class="line">    timeout = <span class="literal">None</span> <span class="keyword">if</span> timeout <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> max(timeout, <span class="number">0</span>)</span><br><span class="line">    ready = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r, w, _ = self._select(self._readers, self._writers, [], timeout)</span><br><span class="line">    <span class="keyword">except</span> InterruptedError:</span><br><span class="line">        <span class="keyword">return</span> ready</span><br><span class="line">    r = set(r)</span><br><span class="line">    w = set(w)</span><br><span class="line">    <span class="keyword">for</span> fd <span class="keyword">in</span> r | w:</span><br><span class="line">        events = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> fd <span class="keyword">in</span> r:</span><br><span class="line">            events |= EVENT_READ</span><br><span class="line">        <span class="keyword">if</span> fd <span class="keyword">in</span> w:</span><br><span class="line">            events |= EVENT_WRITE</span><br><span class="line"></span><br><span class="line">        key = self._key_from_fd(fd)</span><br><span class="line">        <span class="keyword">if</span> key:</span><br><span class="line">            ready.append((key, events &amp; key.events))</span><br><span class="line">    <span class="keyword">return</span> ready</span><br></pre></td></tr></table></figure>


<h3 id="step-5-2"><a href="#step-5-2" class="headerlink" title="step 5.2"></a>step 5.2</h3><p>åœ¨æœ‰å®¢æˆ·ç«¯è¿æ¥è¿›æ¥çš„æ—¶å€™ï¼Œreadyå°±æœ‰æœ‰å€¼ï¼Œä¸ºçœŸï¼Œä¼šæ‰§è¡Œ<code>self._handle_request_noblock</code>æ–¹æ³•</p>
<p>å› ä¸ºæ˜¯self.æ¥è°ƒç”¨çš„ï¼Œæ ¹æ®ç»§æ‰¿è§„åˆ™ï¼Œå°±è¦å›åˆ°æœ€å¼€å§‹çš„ç±»ä¸­ï¼Œå†é€çº§å‘ä¸ŠæŸ¥æ‰¾ï¼Œæ‰€ä»¥å›åˆ°<code>ThreadingTCPServer</code>ä¸­æŸ¥æ‰¾ï¼Œæ²¡æœ‰</p>
<p>æ ¹æ®ç»§æ‰¿çš„è§„åˆ™ï¼Œå†å»å·¦è¾¹çš„çˆ¶ç±»<code>ThreadingMixIn</code>ä¸­æŸ¥æ‰¾ï¼Œæ²¡æœ‰</p>
<p>ä¹‹åå†å»å³è¾¹çš„çˆ¶ç±»<code>TCPServer</code>ä¸­æŸ¥æ‰¾ï¼Œæ²¡æœ‰</p>
<p>æœ€ååœ¨<code>TCPServer</code>çš„çˆ¶ç±»<code>BaseServer</code>ä¸­æ‰¾åˆ°äº†<code>_handle_request_noblock</code>æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_handle_request_noblock</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""Handle one request, without blocking.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    I assume that selector.select() has returned that the socket is</span></span><br><span class="line"><span class="string">    readable before this function was called, so there should be no risk of</span></span><br><span class="line"><span class="string">    blocking in get_request().</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        request, client_address = self.get_request() <span class="comment"># è·å–åˆ°å®¢æˆ·ç«¯è¿æ¥å¯¹è±¡socketï¼Œå’Œå®¢æˆ·ç«¯åœ°å€</span></span><br><span class="line">    <span class="keyword">except</span> OSError:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> self.verify_request(request, client_address):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.process_request(request, client_address)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            self.handle_error(request, client_address)</span><br><span class="line">            self.shutdown_request(request)</span><br></pre></td></tr></table></figure>

<h3 id="step-5-3"><a href="#step-5-3" class="headerlink" title="step 5.3"></a>step 5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request, client_address = self.get_request()</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®ç±»å›¾æŸ¥æ‰¾ï¼Œåœ¨TCPServerç±»ä¸­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_request</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""Get the request and client address from the socket.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    May be overridden.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">return</span> self.socket.accept()</span><br></pre></td></tr></table></figure>

<p>æ¥å—å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚</p>
<h2 id="step-6"><a href="#step-6" class="headerlink" title="step 6"></a>step 6</h2><p>åœ¨<code>_handle_request_noblock</code>æ–¹æ³•ä¸­åˆæ‰§è¡Œäº†<code>self.process_request</code>æ–¹æ³•</p>
<p>å›åˆ°<code>ThreadingTCPServer</code>ä¸­æŸ¥æ‰¾ï¼Œæ²¡æœ‰</p>
<p>æ ¹æ®ç»§æ‰¿çš„è§„åˆ™ï¼Œåœ¨å·¦è¾¹çš„çˆ¶ç±»<code>ThreadingMixIn</code>ä¸­æ‰¾åˆ°è¯¥æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_request</span><span class="params">(self, request, client_address)</span>:</span></span><br><span class="line">    <span class="string">"""Start a new thread to process the request."""</span></span><br><span class="line">    t = threading.Thread(target = self.process_request_thread,</span><br><span class="line">                         args = (request, client_address))</span><br><span class="line">    t.daemon = self.daemon_threads</span><br><span class="line">    t.start()</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œä½¿ç”¨äº†å¤šçº¿ç¨‹å»æ‰§è¡Œ<code>self.process_request_thread</code>æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">t = threading.Thread(target = self.process_request_thread,</span><br><span class="line">                         args = (request, client_address))</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨äº†selfè°ƒç”¨ï¼Œè¿˜æ˜¯è¦ä»å¤´æŸ¥æ‰¾</p>
<h2 id="step-7"><a href="#step-7" class="headerlink" title="step 7"></a>step 7</h2><p>åœ¨<code>ThreadingMixIn</code>ç±»ä¸­æ‰¾åˆ°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_request_thread</span><span class="params">(self, request, client_address)</span>:</span></span><br><span class="line">    <span class="string">"""Same as in BaseServer but as a thread.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    In addition, exception handling is done here.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        self.finish_request(request, client_address)</span><br><span class="line">        self.shutdown_request(request)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        self.handle_error(request, client_address)</span><br><span class="line">        self.shutdown_request(request)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯ç”¨æ¥æ¥æ”¶å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚ä»¥åŠç»™å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</p>
<h2 id="step-8"><a href="#step-8" class="headerlink" title="step 8"></a>step 8</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.finish_request(request, client_address)</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®ç±»å›¾ï¼Œåœ¨<code>BaseServer</code>ä¸­æ‰¾åˆ°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">finish_request</span><span class="params">(self, request, client_address)</span>:</span></span><br><span class="line">    <span class="string">"""Finish one request by instantiating RequestHandlerClass."""</span></span><br><span class="line">    self.RequestHandlerClass(request, client_address, self)</span><br></pre></td></tr></table></figure>

<p>åœ¨<code>step3</code>ä¸­å·²ç»å°è£…äº†<code>RequestHandlerClass = MyClass</code></p>
<p>ç›¸å½“äºæ‰§è¡Œäº†MyClassçš„æ„é€ æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyClass(request, client_address, self)</span><br></pre></td></tr></table></figure>

<h2 id="step-9"><a href="#step-9" class="headerlink" title="step 9"></a>step 9</h2><p>MyClassä¸­æ²¡æœ‰å®šä¹‰æ„é€ æ–¹æ³•ï¼Œåœ¨MyClassç»§æ‰¿çš„çˆ¶ç±»<code>socketserver.BaseRequestHandler</code>ä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°äº†æ„é€ æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, request, client_address, server)</span>:</span></span><br><span class="line">    self.request = request</span><br><span class="line">    self.client_address = client_address</span><br><span class="line">    self.server = server</span><br><span class="line">    self.setup()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        self.handle()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        self.finish()</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œäº†<code>self.handle()</code></p>
<h2 id="step-10"><a href="#step-10" class="headerlink" title="step 10"></a>step 10</h2><p>æ‰§è¡Œ<code>self.handle()</code>æ–¹æ³•æ—¶ï¼Œå°±ä¼šæ‰§è¡ŒMyClassä¸­å®šä¹‰çš„<code>handle</code>æ–¹æ³•</p>
<p>åœ¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å·²ç»è‡ªå®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•å»å®ç°ä¸å®¢æˆ·ç«¯çš„äº¤äº’ï¼Œ</p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/15/CentOS%E6%8C%82%E8%BD%BDexFAT%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/15/CentOS%E6%8C%82%E8%BD%BDexFAT%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="post-title-link" itemprop="url">CentOSæŒ‚è½½exFATæ–‡ä»¶ç³»ç»Ÿ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-15 14:43:23" itemprop="dateCreated datePublished" datetime="2016-07-15T14:43:23+08:00">2016-07-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/15/CentOS%E6%8C%82%E8%BD%BDexFAT%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/15/CentOSæŒ‚è½½exFATæ–‡ä»¶ç³»ç»Ÿ/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ä¸‹è½½è½¯ä»¶"><a href="#ä¸‹è½½è½¯ä»¶" class="headerlink" title="ä¸‹è½½è½¯ä»¶"></a>ä¸‹è½½è½¯ä»¶</h1><p><a href="http://oss.20150509.cn/exfat-utils-1.0.1-2.el6.src.rpm" target="_blank" rel="noopener">http://oss.20150509.cn/exfat-utils-1.0.1-2.el6.src.rpm</a></p>
<p><a href="http://oss.20150509.cn/fuse-exfat-1.0.1-2.el6.src.rpm" target="_blank" rel="noopener">http://oss.20150509.cn/fuse-exfat-1.0.1-2.el6.src.rpm</a></p>
<h1 id="ç¼–è¯‘å®‰è£…"><a href="#ç¼–è¯‘å®‰è£…" class="headerlink" title="ç¼–è¯‘å®‰è£…"></a>ç¼–è¯‘å®‰è£…</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; yum install scons gcc  <span class="comment"># ç¼–è¯‘å®‰è£…éœ€è¦ç³»ç»Ÿæœ‰è¿™ä¸¤ä¸ªè½¯ä»¶çš„æ”¯æŒ</span></span><br><span class="line">&gt; yum install fuse-devel  <span class="comment"># fuseæ¨¡å—ï¼Œç¼–è¯‘éœ€è¦fuse-develåŒ…æ”¯æŒ</span></span><br><span class="line">&gt; rpm -ivh fuse-exfat-1.0.1-2.el6.src.rpm exfat-utils-1.0.1-2.el6.src.rpm&gt;</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="built_in">cd</span> ~/rpmbuild/SPECS</span><br><span class="line">&gt; rpmbuild -ba fuse-exfat.spec</span><br><span class="line">&gt; rpmbuild -ba exfat-utils.spec</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="built_in">cd</span> ~/rpmbuild/RPMS/x86_64</span><br><span class="line">&gt; rpm -ivh fuse-exfat-1.0.1-2.el6.x86_64.rpm exfat-utils-1.0.1-2.el6.x86_64.rpm</span><br></pre></td></tr></table></figure>

<h1 id="æŒ‚è½½"><a href="#æŒ‚è½½" class="headerlink" title="æŒ‚è½½"></a>æŒ‚è½½</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; mount.exfat /dev/sdx /mnt</span><br><span class="line">&gt; <span class="comment"># or</span></span><br><span class="line">&gt; mount -t exfat /dev/sdx /mnt</span><br></pre></td></tr></table></figure>

<p><em>å¦‚æœæŒ‡å®š-tæ‰¾ä¸åˆ°æ­¤ç±»å‹çš„è¯æ‰§è¡Œï¼šln -s /usr/sbin/mount.exfat /sbin/mount.exfat</em></p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/12/Python%E4%B8%8B%E4%BD%BF%E7%94%A8IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8-%E5%85%A5%E9%97%A8%E7%AF%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/12/Python%E4%B8%8B%E4%BD%BF%E7%94%A8IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8-%E5%85%A5%E9%97%A8%E7%AF%87/" class="post-title-link" itemprop="url">Pythonä¸‹ä½¿ç”¨IOå¤šè·¯å¤ç”¨(å…¥é—¨ç¯‡)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-12 03:49:36" itemprop="dateCreated datePublished" datetime="2016-07-12T03:49:36+08:00">2016-07-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/12/Python%E4%B8%8B%E4%BD%BF%E7%94%A8IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8-%E5%85%A5%E9%97%A8%E7%AF%87/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/12/Pythonä¸‹ä½¿ç”¨IOå¤šè·¯å¤ç”¨-å…¥é—¨ç¯‡/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>IOæ“ä½œæ˜¯ä¸å ç”¨CPUçš„ï¼ŒIOå¤šè·¯å¤ç”¨ï¼Œæ˜¯è¦ç®¡ç†èµ·æ‰€æœ‰çš„IOæ“ä½œã€‚IOå¤šè·¯å¤ç”¨çš„å…¸å‹åœºæ™¯æ˜¯ç›‘å¬socketå¯¹è±¡å†…éƒ¨æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–</p>
</blockquote>
<p>socketå†…éƒ¨ä»€ä¹ˆæ—¶å€™ä¼šæœ‰å˜åŒ–ï¼š</p>
<ul>
<li>å»ºç«‹è¿æ¥</li>
<li>å‘é€æ¶ˆæ¯</li>
</ul>
<h1 id="socketå®ä¾‹"><a href="#socketå®ä¾‹" class="headerlink" title="socketå®ä¾‹"></a>socketå®ä¾‹</h1><p>è¿™é‡Œä½¿ç”¨socketå®ç°ä¸€ä¸ªç®€å•çš„Echo Serverçš„åŠŸèƒ½</p>
<ul>
<li><font color="red">server.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºsocketå¯¹è±¡,ç»‘å®šIPç«¯å£,ç›‘å¬</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾ªç¯æ¥å—æ¯ä¸€ä¸ªè¿æ¥æ± ä¸­çš„è¿æ¥</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># æ¥å—å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">    conn, address = sk.accept()</span><br><span class="line">    <span class="comment"># å‘å®¢æˆ·ç«¯å‘é€æ¬¢è¿æ¶ˆæ¯</span></span><br><span class="line">    conn.sendall(bytes(<span class="string">'hello'</span>, encoding=<span class="string">'utf8'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿›å…¥åˆ°æ”¶å‘æ¶ˆæ¯çš„å¾ªç¯ä¸­</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Windowså®¢æˆ·ç«¯åœ¨å¼‚å¸¸æ–­å¼€åæŠ›å‡ºå¼‚å¸¸,è¿™é‡Œæ˜¯å¤„ç†Windowsçš„æ–­å¼€æƒ…å†µ</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            recv = conn.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Linuxå®¢æˆ·ç«¯æ–­å¼€recvä¼šæ˜¯ç©ºå€¼,è¿™é‡Œå¤„ç†Linuxçš„æ–­å¼€æƒ…å†µ</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> recv:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¿™é‡Œå¤„ç†å®¢æˆ·ç«¯ä¸»åŠ¨å‘å‡ºæ–­å¼€è¯·æ±‚çš„æƒ…å†µ</span></span><br><span class="line">            <span class="keyword">if</span> str(recv, encoding=<span class="string">'utf-8'</span>) == <span class="string">'exit'</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å‘å®¢æˆ·ç«¯å‘é€æ•°æ®</span></span><br><span class="line">        conn.sendall(recv)</span><br></pre></td></tr></table></figure>

<ul>
<li><font color="blue">client.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.connect((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line"><span class="comment"># æ¥æ”¶æ¬¢è¿æ¶ˆæ¯</span></span><br><span class="line">data = sk.recv(<span class="number">1024</span>)</span><br><span class="line">print(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = input(<span class="string">"&gt; "</span>)</span><br><span class="line">    <span class="comment"># å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯</span></span><br><span class="line">    sk.sendall(bytes(i, encoding=<span class="string">'utf8'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ¥æ”¶æœåŠ¡ç«¯å‘æ¥çš„æ¶ˆæ¯</span></span><br><span class="line">    msg = sk.recv(<span class="number">1024</span>)</span><br><span class="line">    print(str(msg, encoding=<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">sk.close()</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šçš„socketä»£ç åŒä¸€æ—¶é—´ä»…èƒ½å¤„ç†ä¸€ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¹‹åè¿æ¥ä¸Šæ¥çš„å®¢æˆ·ç«¯åœ¨ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯è¿˜æ²¡æœ‰æ–­å¼€çš„æ—¶å€™ï¼Œä¼šä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°ä¸Šä¸€ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚æ–­å¼€</p>
<h1 id="select-selext-ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°"><a href="#select-selext-ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°" class="headerlink" title="select.selext()ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°"></a>select.selext()ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°</h1><h2 id="å»ºç«‹è¿æ¥"><a href="#å»ºç«‹è¿æ¥" class="headerlink" title="å»ºç«‹è¿æ¥"></a>å»ºç«‹è¿æ¥</h2><p>ä¸Šé¢è¯´åˆ°ï¼Œä¸€ç§socketä¼šå˜çš„æƒ…å†µæ˜¯å»ºç«‹è¿æ¥</p>
<p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ¶‰åŠåˆ°å»ºç«‹è¿æ¥çš„socketæ˜¯skå¯¹è±¡ï¼ˆå˜é‡ï¼‰skå¯¹è±¡åœ¨æ‰§è¡Œåˆ°<code>sk.accept()</code>æ—¶ï¼Œæ¥å—äº†ä¸€ä¸ªæ–°å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚æ—¶å€™ï¼Œsocketå†…éƒ¨å°±å‘ç”Ÿäº†å˜åŒ–ï¼Œæˆ‘ä»¬å°±éœ€è¦ç›‘å¬è¿™ç§å˜åŒ–ï¼Œç”¨ä»¥åˆ†è¾¨å‡ºæ–°çš„å®¢æˆ·ç«¯çš„è¿æ¥</p>
<p><em>åˆ›å»ºsocketï¼Œç»‘å®šå¹¶ç›‘å¬ä¹‹åsocketä¸€èˆ¬ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåªæœ‰å½“æœ‰æ–°çš„å®¢æˆ·ç«¯è¿æ¥è¿›æ¥çš„æ—¶å€™ï¼Œsocketæ‰ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦ç›‘å¬çš„ä¹Ÿæ˜¯è¿™ä¸ªé˜¶æ®µçš„å˜åŒ–</em></p>
<p><strong>å¾—å‡ºç»“è®ºï¼šå½“socketè¢«åˆ›å»ºã€ç»‘å®šå¹¶ç›‘å¬ä¹‹åå‘ç”Ÿå˜åŒ–ï¼Œå°±æ˜¯æœ‰æ–°çš„å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥</strong></p>
<ul>
<li><font color="red">server.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºsocketå¯¹è±¡,ç»‘å®šIPç«¯å£,ç›‘å¬</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    rList, w, e = select.select([sk,], [], [], <span class="number">1</span>)</span><br><span class="line">    print(rList)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å¼•å…¥äº†IOå¤šè·¯å¤ç”¨ä¸­çš„selectæ¨¡å‹ï¼Œä½¿ç”¨select.select()æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªæœ‰ä¸‰ä¸ªå…ƒç´ çš„å…ƒç¥–</p>
<p>åœ¨select.select()æ–¹æ³•ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæš‚æ—¶åªæ·»åŠ äº†ä¸€ä¸ªæœåŠ¡ç«¯çš„socketå¯¹è±¡ï¼Œåªè¦æœåŠ¡ç«¯socketå¯¹è±¡skæœ‰å˜åŒ–ï¼ˆæ–°çš„å®¢æˆ·ç«¯è¿æ¥ï¼‰å°±ç«‹å³æŠŠå˜åŒ–çš„socketå¯¹è±¡åŠ å…¥åˆ°rListåˆ—è¡¨ä¸­</p>
<p><strong>ç›‘å¬çš„socketåˆ—è¡¨ä¸­ï¼Œskå¯¹è±¡æœ‰å˜åŒ– â€”&gt; rList = [sk]</strong></p>
<p><strong>ç›‘å¬çš„socketåˆ—è¡¨ä¸­ï¼Œæ²¡æœ‰socketå‘ç”Ÿå˜åŒ– â€”&gt; rList = []</strong></p>
<p>ä»¥ä¸Šä»£ç è·‘èµ·æ¥çš„æ•ˆæœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[]</span><br><span class="line">[]</span><br><span class="line">[]</span><br><span class="line">...</span><br><span class="line"># æ¯ç§’æ‰“å°ä¸€ä¸ª[]</span><br><span class="line"># select.sekect()ä¸­çš„ç¬¬å››ä¸ªå‚æ•°èµ·äº†ä½œç”¨</span><br><span class="line"># è¶…æ—¶æ—¶é—´ï¼Œç›‘å¬çš„å¯¹è±¡æ²¡æœ‰å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå¤šå°‘ç§’å¾ªç¯ä¸€æ¬¡</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜æ²¡æœ‰æ–°çš„è¿æ¥è¯·æ±‚ï¼Œä¸‹é¢å°†è¯•éªŒæœ‰å®¢æˆ·ç«¯è¿æ¥äº§ç”Ÿçš„æƒ…å†µ</p>
<ul>
<li><font color="blue">client.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.connect((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.close()</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯ä¸€æ—¦è¿æ¥åˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯çš„å›æ˜¾å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[&lt;socket.socket fd&#x3D;3, family&#x3D;AddressFamily.AF_INET, type&#x3D;SocketKind.SOCK_STREAM, proto&#x3D;0, laddr&#x3D;(&#39;127.0.0.1&#39;, 1559)&gt;]</span><br><span class="line">[&lt;socket.socket fd&#x3D;3, family&#x3D;AddressFamily.AF_INET, type&#x3D;SocketKind.SOCK_STREAM, proto&#x3D;0, laddr&#x3D;(&#39;127.0.0.1&#39;, 1559)&gt;]</span><br><span class="line">[&lt;socket.socket fd&#x3D;3, family&#x3D;AddressFamily.AF_INET, type&#x3D;SocketKind.SOCK_STREAM, proto&#x3D;0, laddr&#x3D;(&#39;127.0.0.1&#39;, 1559)&gt;]</span><br><span class="line">...</span><br><span class="line"># ç–¯ç‹‚çš„å¿«é€Ÿæ‰“å°...</span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥è¿›æ¥äº†ã€‚æœåŠ¡ç«¯çš„skå¯¹è±¡å†…éƒ¨å‘ç”Ÿäº†å˜åŒ–ï¼Œå½“selectç›‘å¬åˆ°skå¯¹è±¡å‘ç”Ÿå˜åŒ–åï¼Œç«‹å³å°†å‘ç”Ÿå˜åŒ–çš„å¯¹è±¡èµ‹å€¼ç»™äº†rListåˆ—è¡¨ï¼ˆappendåˆ°åˆ—è¡¨ï¼‰ä»æ‰“å°å‡ºæ¥çš„å†…å®¹ä¸­å¯ä»¥çœ‹å‡ºï¼Œåˆ—è¡¨ä¸­çš„å…ƒç´ æ˜¯å‘ç”Ÿå˜åŒ–çš„socketå¯¹è±¡</p>
<h3 id="å¤„ç†rListï¼ˆæœåŠ¡ç«¯socketï¼‰"><a href="#å¤„ç†rListï¼ˆæœåŠ¡ç«¯socketï¼‰" class="headerlink" title="å¤„ç†rListï¼ˆæœåŠ¡ç«¯socketï¼‰"></a>å¤„ç†rListï¼ˆæœåŠ¡ç«¯socketï¼‰</h3><p>rListä¸­ä¿å­˜äº†æ‰€æœ‰å‘ç”Ÿå˜åŒ–çš„socketå¯¹è±¡ï¼Œä»¥ä¸Šä»£ç ä¸­åªç›‘å¬äº†æœåŠ¡ç«¯socketå¯¹è±¡ï¼Œè¿™é‡Œæš‚æ—¶åªè®¨è®ºæœåŠ¡ç«¯socketå˜åŒ–çš„æƒ…å†µ</p>
<ul>
<li><font color="red">server.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºsocketå¯¹è±¡,ç»‘å®šIPç«¯å£,ç›‘å¬</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	<span class="comment"># ç›‘å¬æœåŠ¡ç«¯socketå¯¹è±¡sk</span></span><br><span class="line">    rList, w, e = select.select([sk,], [], [], <span class="number">1</span>)</span><br><span class="line">    print(rList)</span><br><span class="line">	</span><br><span class="line">	<span class="comment"># éå†rListä¸­çš„æ¯ä¸€ä¸ªsocketå¯¹è±¡</span></span><br><span class="line">	<span class="comment"># ç›®å‰rListä¸­åªä¼šå‡ºç°æœåŠ¡ç«¯çš„socketå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> rList:</span><br><span class="line">        conn, address = s.accept()</span><br><span class="line">        conn.sendall(bytes(<span class="string">'hello'</span>, encoding=<span class="string">'utf8'</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li><font color="blue">client.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.connect((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">data = sk.recv(<span class="number">1024</span>)</span><br><span class="line">print(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    input(<span class="string">"&gt; "</span>)</span><br><span class="line"></span><br><span class="line">sk.close()</span><br></pre></td></tr></table></figure>

<p>è¿ç»­è¿è¡Œä¸‰ä¸ªå®¢æˆ·ç«¯è¿æ¥æ—¶ï¼ŒæœåŠ¡ç«¯çš„å›æ˜¾ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[]</span><br><span class="line">[]</span><br><span class="line">[&lt;socket.socket fd&#x3D;3, family&#x3D;AddressFamily.AF_INET, type&#x3D;SocketKind.SOCK_STREAM, proto&#x3D;0, laddr&#x3D;(&#39;127.0.0.1&#39;, 1559)&gt;]</span><br><span class="line">[]</span><br><span class="line">[&lt;socket.socket fd&#x3D;3, family&#x3D;AddressFamily.AF_INET, type&#x3D;SocketKind.SOCK_STREAM, proto&#x3D;0, laddr&#x3D;(&#39;127.0.0.1&#39;, 1559)&gt;]</span><br><span class="line">[]</span><br><span class="line">[&lt;socket.socket fd&#x3D;3, family&#x3D;AddressFamily.AF_INET, type&#x3D;SocketKind.SOCK_STREAM, proto&#x3D;0, laddr&#x3D;(&#39;127.0.0.1&#39;, 1559)&gt;]</span><br><span class="line">[]</span><br><span class="line">[]</span><br></pre></td></tr></table></figure>


<p><strong>æ¯ä¸ª</strong>å®¢æˆ·ç«¯çš„å›æ˜¾ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b&#39;hello&#39;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šé€šè¿‡å¯¹rListä¸­æœåŠ¡ç«¯socketå¯¹è±¡æ‰§è¡Œaccept()æ–¹æ³•ï¼Œæ¥å®ç°äº†ä¸€ä¸ªç±»ä¼¼å¹¶å‘è¿æ¥çš„æ•ˆæœï¼Œæ¯ä¸€ä¸ªè¿æ¥è¿›æ¥çš„å®¢æˆ·ç«¯éƒ½ä¼šè¢«æœåŠ¡ç«¯æ¥å—è¯·æ±‚ï¼Œâ€œåŒæ—¶â€æä¾›æœåŠ¡</p>
<h2 id="æ¥æ”¶å®¢æˆ·ç«¯æ¶ˆæ¯"><a href="#æ¥æ”¶å®¢æˆ·ç«¯æ¶ˆæ¯" class="headerlink" title="æ¥æ”¶å®¢æˆ·ç«¯æ¶ˆæ¯"></a>æ¥æ”¶å®¢æˆ·ç«¯æ¶ˆæ¯</h2><p>ä¸Šé¢æåˆ°ï¼Œä¸ä»…åˆ›å»ºè¿æ¥ä¼šè§¦å‘socketçš„å˜åŒ–ï¼Œä¸å®¢æˆ·ç«¯è¿æ¥å»ºç«‹åï¼Œå®¢æˆ·ç«¯å‘æ¥æ¶ˆæ¯ï¼Œä¹Ÿä¼šå¼•å‘å®¢æˆ·ç«¯socketè¿æ¥çš„å†…éƒ¨å˜åŒ–</p>
<ul>
<li><font color="red">server.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºsocketå¯¹è±¡,ç»‘å®šIPç«¯å£,ç›‘å¬</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">inputs = [sk]</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    rList, w, e = select.select(inputs, [], [], <span class="number">1</span>)</span><br><span class="line">    print(rList)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> rList:</span><br><span class="line">        conn, address = s.accept()</span><br><span class="line">        <span class="comment"># connä¹Ÿæ˜¯ä¸€ä¸ªsocketå¯¹è±¡</span></span><br><span class="line">        <span class="comment"># å½“æœåŠ¡ç«¯socketæ¥æ”¶åˆ°å®¢æˆ·çš„è¯·æ±‚å,ä¼šåˆ†é…ä¸€ä¸ªæ–°çš„socketå¯¹è±¡ä¸“é—¨ç”¨æ¥å’Œè¿™ä¸ªå®¢æˆ·ç«¯è¿›è¡Œè¿æ¥é€šä¿¡</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å½“æœåŠ¡ç«¯åˆ†é…æ–°çš„socketå¯¹è±¡ç»™æ–°è¿æ¥è¿›æ¥çš„å®¢æˆ·ç«¯çš„æ—¶å€™</span></span><br><span class="line">        <span class="comment"># æˆ‘ä»¬ä¹Ÿéœ€è¦ç›‘å¬è¿™ä¸ªå®¢æˆ·ç«¯çš„socketå¯¹è±¡æ˜¯å¦ä¼šå‘ç”Ÿå˜åŒ–</span></span><br><span class="line">        <span class="comment"># ä¸€æ—¦å‘ç”Ÿå˜åŒ–,æ„å‘³ç€å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘æ¥äº†æ¶ˆæ¯</span></span><br><span class="line">        inputs.append(conn)</span><br><span class="line">        conn.sendall(bytes(<span class="string">'hello'</span>, encoding=<span class="string">'utf8'</span>))</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘æŠŠæœåŠ¡ç«¯socketä¸ºæ–°å®¢æˆ·ç«¯åˆ›å»ºçš„socketä¹ŸåŠ å…¥åˆ°äº†ç›‘å¬åˆ—è¡¨ä¸­ï¼Œé‚£ä¹ˆå¦‚æœæœ‰å®¢æˆ·ç«¯å‘æ¥æ¶ˆæ¯ï¼Œselectç›‘å¬åˆ°å®¢æˆ·ç«¯socketï¼ˆconnï¼‰å‘ç”Ÿå˜åŒ–å¹¶åŠ å…¥åˆ°rListåˆ—è¡¨ä¸­åï¼Œåœ¨forå¾ªç¯å¤„ç†ä¸­ï¼Œå®¢æˆ·ç«¯çš„socketå¹¶æ²¡æœ‰accept()æ–¹æ³•ï¼Œè€Œä¸”ä¹Ÿä¸è¦è¿™ä¸ªæ–¹æ³•ï¼Œè¿™å°±éœ€è¦åœ¨forå¾ªç¯ä¸­å¯¹ä¸¤ç±»socketåŒºåˆ†å¯¹å¾…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºsocketå¯¹è±¡,ç»‘å®šIPç«¯å£,ç›‘å¬</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">inputs = [sk]</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    rList, w, e = select.select(inputs, [], [], <span class="number">1</span>)</span><br><span class="line">    print(<span class="string">"selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt;"</span>, len(inputs), <span class="string">" | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt;"</span>, len(rList))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> rList:</span><br><span class="line">        <span class="comment"># åˆ¤æ–­socketå¯¹è±¡å¦‚æœæ˜¯æœåŠ¡ç«¯çš„socketå¯¹è±¡çš„è¯</span></span><br><span class="line">        <span class="keyword">if</span> s == sk:</span><br><span class="line">            conn, address = s.accept()</span><br><span class="line">            <span class="comment"># connä¹Ÿæ˜¯ä¸€ä¸ªsocketå¯¹è±¡</span></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯socketæ¥æ”¶åˆ°å®¢æˆ·çš„è¯·æ±‚å,ä¼šåˆ†é…ä¸€ä¸ªæ–°çš„socketå¯¹è±¡ä¸“é—¨ç”¨æ¥å’Œè¿™ä¸ªå®¢æˆ·ç«¯è¿›è¡Œè¿æ¥é€šä¿¡</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯åˆ†é…æ–°çš„socketå¯¹è±¡ç»™æ–°è¿æ¥è¿›æ¥çš„å®¢æˆ·ç«¯çš„æ—¶å€™</span></span><br><span class="line">            <span class="comment"># æˆ‘ä»¬ä¹Ÿéœ€è¦ç›‘å¬è¿™ä¸ªå®¢æˆ·ç«¯çš„socketå¯¹è±¡æ˜¯å¦ä¼šå‘ç”Ÿå˜åŒ–</span></span><br><span class="line">            <span class="comment"># ä¸€æ—¦å‘ç”Ÿå˜åŒ–,æ„å‘³ç€å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘æ¥äº†æ¶ˆæ¯</span></span><br><span class="line">            inputs.append(conn)</span><br><span class="line">            conn.sendall(bytes(<span class="string">'hello'</span>, encoding=<span class="string">'utf8'</span>))</span><br><span class="line">        <span class="comment"># å…¶ä»–çš„å°±éƒ½æ˜¯å®¢æˆ·ç«¯çš„socketå¯¹è±¡äº†</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># æ„å‘³ç€å®¢æˆ·ç«¯ç»™æœåŠ¡ç«¯å‘é€æ¶ˆæ¯äº†</span></span><br><span class="line">            msg = s.recv(<span class="number">1024</span>)</span><br><span class="line">            print(msg)</span><br></pre></td></tr></table></figure>

<ul>
<li><font color="blue">client.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.connect((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line"><span class="comment"># æ¥æ”¶æ¬¢è¿æ¶ˆæ¯</span></span><br><span class="line">data = sk.recv(<span class="number">1024</span>)</span><br><span class="line">print(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = input(<span class="string">"&gt; "</span>)</span><br><span class="line">    <span class="comment"># å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯</span></span><br><span class="line">    sk.sendall(bytes(i, encoding=<span class="string">'utf8'</span>))</span><br><span class="line"></span><br><span class="line">sk.close()</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘è¿è¡Œä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå¹¶Ctrl+Cé€€å‡ºæ—¶ï¼ŒæœåŠ¡ç«¯å›æ˜¾ç•Œé¢åœ¨ç–¯ç‹‚çš„æ‰“å°æ¶ˆæ¯ã€‚é—®é¢˜å‡ºåœ¨äº†æœåŠ¡ç«¯ç›‘å¬çš„å®¢æˆ·ç«¯socketè¿æ¥ï¼Œå½“å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œåº”åœ¨æœåŠ¡ç«¯selectç›‘å¬socketå¯¹è±¡åˆ—è¡¨ä¸­å°†è¯¥å®¢æˆ·ç«¯socketå¯¹è±¡ç§»é™¤</p>
<ul>
<li><font color="red">server.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºsocketå¯¹è±¡,ç»‘å®šIPç«¯å£,ç›‘å¬</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">inputs = [sk]</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    rList, w, e = select.select(inputs, [], [], <span class="number">1</span>)</span><br><span class="line">    print(<span class="string">"selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt;"</span>, len(inputs), <span class="string">" | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt;"</span>, len(rList))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> rList:</span><br><span class="line">        <span class="comment"># åˆ¤æ–­socketå¯¹è±¡å¦‚æœæ˜¯æœåŠ¡ç«¯çš„socketå¯¹è±¡çš„è¯</span></span><br><span class="line">        <span class="keyword">if</span> s == sk:</span><br><span class="line">            conn, address = s.accept()</span><br><span class="line">            <span class="comment"># connä¹Ÿæ˜¯ä¸€ä¸ªsocketå¯¹è±¡</span></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯socketæ¥æ”¶åˆ°å®¢æˆ·çš„è¯·æ±‚å,ä¼šåˆ†é…ä¸€ä¸ªæ–°çš„socketå¯¹è±¡ä¸“é—¨ç”¨æ¥å’Œè¿™ä¸ªå®¢æˆ·ç«¯è¿›è¡Œè¿æ¥é€šä¿¡</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯åˆ†é…æ–°çš„socketå¯¹è±¡ç»™æ–°è¿æ¥è¿›æ¥çš„å®¢æˆ·ç«¯çš„æ—¶å€™</span></span><br><span class="line">            <span class="comment"># æˆ‘ä»¬ä¹Ÿéœ€è¦ç›‘å¬è¿™ä¸ªå®¢æˆ·ç«¯çš„socketå¯¹è±¡æ˜¯å¦ä¼šå‘ç”Ÿå˜åŒ–</span></span><br><span class="line">            <span class="comment"># ä¸€æ—¦å‘ç”Ÿå˜åŒ–,æ„å‘³ç€å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘æ¥äº†æ¶ˆæ¯</span></span><br><span class="line">            inputs.append(conn)</span><br><span class="line">            conn.sendall(bytes(<span class="string">'hello'</span>, encoding=<span class="string">'utf8'</span>))</span><br><span class="line">        <span class="comment"># å…¶ä»–çš„å°±éƒ½æ˜¯å®¢æˆ·ç«¯çš„socketå¯¹è±¡äº†</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># æ„å‘³ç€å®¢æˆ·ç«¯ç»™æœåŠ¡ç«¯å‘é€æ¶ˆæ¯äº†</span></span><br><span class="line">                msg = s.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Linuxå¹³å°ä¸‹çš„å¤„ç†</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> msg:</span><br><span class="line">                    <span class="keyword">raise</span> Exception(<span class="string">'å®¢æˆ·ç«¯å·²æ–­å¼€è¿æ¥'</span>)</span><br><span class="line">                print(msg)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">                <span class="comment"># Windowså¹³å°ä¸‹çš„å¤„ç†</span></span><br><span class="line">                inputs.remove(s)</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨æœ€æ–°çš„server.pyä¸client.pyè¿›è¡Œæµ‹è¯•æ—¶ï¼Œä¾æ¬¡è¿è¡Œå¤šä¸ªå®¢æˆ·ç«¯ï¼Œå†ä¾æ¬¡å…³é—­å¤šä¸ªå®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯çš„å›æ˜¾å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 2  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 2  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 2  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">b&#39;&#39;</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">b&#39;&#39;</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 2  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 2  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">b&#39;&#39;</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br></pre></td></tr></table></figure>

<p><strong>ç‰¹åˆ«æ³¨æ„ï¼š</strong>è¿™é‡Œçš„æœåŠ¡ç«¯å®šä¹‰ï¼Œå½“æˆ‘æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„ç©ºå€¼çš„æ—¶å€™ï¼Œæˆ‘å°±é»˜è®¤è®¤ä¸ºå®¢æˆ·ç«¯ä¸»åŠ¨éœ€è¦æ–­å¼€ä¸æœåŠ¡ç«¯çš„è¿æ¥ã€‚ç”±äºæœåŠ¡ç«¯çš„è¿™ä¸ªé»˜è®¤è§„åˆ™ï¼Œåœ¨å†™å®¢æˆ·ç«¯çš„æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„å¤„ç†å®¢æˆ·ç«¯è¾“å…¥çš„å€¼ä¸ºç©ºçš„æƒ…å†µ</p>
<h2 id="ç»™å®¢æˆ·ç«¯å›å¤æ¶ˆæ¯"><a href="#ç»™å®¢æˆ·ç«¯å›å¤æ¶ˆæ¯" class="headerlink" title="ç»™å®¢æˆ·ç«¯å›å¤æ¶ˆæ¯"></a>ç»™å®¢æˆ·ç«¯å›å¤æ¶ˆæ¯</h2><ul>
<li><font color="red">server.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºsocketå¯¹è±¡,ç»‘å®šIPç«¯å£,ç›‘å¬</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">inputs = [sk]</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    rList, w, e = select.select(inputs, [], [], <span class="number">1</span>)</span><br><span class="line">    print(<span class="string">"selectå½“å‰ç›‘å¬socketå¯¹è±¡çš„æ•°é‡&gt;"</span>, len(inputs), <span class="string">" | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt;"</span>, len(rList))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> rList:</span><br><span class="line">        <span class="comment"># åˆ¤æ–­socketå¯¹è±¡å¦‚æœæ˜¯æœåŠ¡ç«¯çš„socketå¯¹è±¡çš„è¯</span></span><br><span class="line">        <span class="keyword">if</span> s == sk:</span><br><span class="line">            conn, address = s.accept()</span><br><span class="line">            <span class="comment"># connä¹Ÿæ˜¯ä¸€ä¸ªsocketå¯¹è±¡</span></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯socketæ¥æ”¶åˆ°å®¢æˆ·çš„è¯·æ±‚å,ä¼šåˆ†é…ä¸€ä¸ªæ–°çš„socketå¯¹è±¡ä¸“é—¨ç”¨æ¥å’Œè¿™ä¸ªå®¢æˆ·ç«¯è¿›è¡Œè¿æ¥é€šä¿¡</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯åˆ†é…æ–°çš„socketå¯¹è±¡ç»™æ–°è¿æ¥è¿›æ¥çš„å®¢æˆ·ç«¯çš„æ—¶å€™</span></span><br><span class="line">            <span class="comment"># æˆ‘ä»¬ä¹Ÿéœ€è¦ç›‘å¬è¿™ä¸ªå®¢æˆ·ç«¯çš„socketå¯¹è±¡æ˜¯å¦ä¼šå‘ç”Ÿå˜åŒ–</span></span><br><span class="line">            <span class="comment"># ä¸€æ—¦å‘ç”Ÿå˜åŒ–,æ„å‘³ç€å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘æ¥äº†æ¶ˆæ¯</span></span><br><span class="line">            inputs.append(conn)</span><br><span class="line">            conn.sendall(bytes(<span class="string">'hello'</span>, encoding=<span class="string">'utf8'</span>))</span><br><span class="line">        <span class="comment"># å…¶ä»–çš„å°±éƒ½æ˜¯å®¢æˆ·ç«¯çš„socketå¯¹è±¡äº†</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># æ„å‘³ç€å®¢æˆ·ç«¯ç»™æœåŠ¡ç«¯å‘é€æ¶ˆæ¯äº†</span></span><br><span class="line">                msg = s.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Linuxå¹³å°ä¸‹çš„å¤„ç†</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> msg:</span><br><span class="line">                    <span class="keyword">raise</span> Exception(<span class="string">'å®¢æˆ·ç«¯å·²æ–­å¼€è¿æ¥'</span>)</span><br><span class="line">                print(msg)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å‘å®¢æˆ·ç«¯å›å¤æ¶ˆæ¯</span></span><br><span class="line">                <span class="comment"># è¿™ç§å†™æ³•æ˜¯å®Œå…¨å¯ä»¥çš„,ä½†æ˜¯ç¼ºç‚¹æ˜¯è¯»å†™éƒ½æ··åœ¨äº†ä¸€èµ·</span></span><br><span class="line">                s.sendall(msg)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">                <span class="comment"># Windowså¹³å°ä¸‹çš„å¤„ç†</span></span><br><span class="line">                inputs.remove(s)</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼šåšè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥é€šè¿‡selectï¼Œå®ç°è¯»å†™åˆ†ç¦»ï¼ˆæ”¶å‘åˆ†ç¦»ï¼‰</p>
<h1 id="select-selext-ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°"><a href="#select-selext-ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°" class="headerlink" title="select.selext()ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°"></a>select.selext()ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rList, wList, e = select.select([], [], [], <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>select.select()çš„ç¬¬äºŒä¸ªå‚æ•°æœ‰ä»€ä¹ˆå€¼ï¼ŒwListä¸­å°±ä¼šæœ‰ä»€ä¹ˆå€¼</p>
<p>åˆ©ç”¨selectçš„è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥æŠŠéœ€è¦å›å¤æ¶ˆæ¯çš„å®¢æˆ·ç«¯socketå¯¹è±¡èµ‹å€¼ç»™selectçš„ç¬¬äºŒä¸ªå‚æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºsocketå¯¹è±¡,ç»‘å®šIPç«¯å£,ç›‘å¬</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">inputs = [sk]</span><br><span class="line">outputs = []</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    rList, wList, e = select.select(inputs, outputs, [], <span class="number">1</span>)</span><br><span class="line">    print(<span class="string">"---"</span> * <span class="number">20</span>)</span><br><span class="line">    print(<span class="string">"selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt;"</span>, len(inputs), <span class="string">" | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt;"</span>, len(rList))</span><br><span class="line">    print(<span class="string">"selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt;"</span>, len(outputs), <span class="string">" | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt;"</span>, len(wList))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éå†rList(å»ºç«‹è¿æ¥å’Œæ¥æ”¶æ•°æ®)</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> rList:</span><br><span class="line">        <span class="comment"># åˆ¤æ–­socketå¯¹è±¡å¦‚æœæ˜¯æœåŠ¡ç«¯çš„socketå¯¹è±¡çš„è¯</span></span><br><span class="line">        <span class="keyword">if</span> s == sk:</span><br><span class="line">            conn, address = s.accept()</span><br><span class="line">            <span class="comment"># connä¹Ÿæ˜¯ä¸€ä¸ªsocketå¯¹è±¡</span></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯socketæ¥æ”¶åˆ°å®¢æˆ·çš„è¯·æ±‚å,ä¼šåˆ†é…ä¸€ä¸ªæ–°çš„socketå¯¹è±¡ä¸“é—¨ç”¨æ¥å’Œè¿™ä¸ªå®¢æˆ·ç«¯è¿›è¡Œè¿æ¥é€šä¿¡</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯åˆ†é…æ–°çš„socketå¯¹è±¡ç»™æ–°è¿æ¥è¿›æ¥çš„å®¢æˆ·ç«¯çš„æ—¶å€™</span></span><br><span class="line">            <span class="comment"># æˆ‘ä»¬ä¹Ÿéœ€è¦ç›‘å¬è¿™ä¸ªå®¢æˆ·ç«¯çš„socketå¯¹è±¡æ˜¯å¦ä¼šå‘ç”Ÿå˜åŒ–</span></span><br><span class="line">            <span class="comment"># ä¸€æ—¦å‘ç”Ÿå˜åŒ–,æ„å‘³ç€å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘æ¥äº†æ¶ˆæ¯</span></span><br><span class="line">            inputs.append(conn)</span><br><span class="line">            conn.sendall(bytes(<span class="string">'hello'</span>, encoding=<span class="string">'utf8'</span>))</span><br><span class="line">        <span class="comment"># å…¶ä»–çš„å°±éƒ½æ˜¯å®¢æˆ·ç«¯çš„socketå¯¹è±¡äº†</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># æ„å‘³ç€å®¢æˆ·ç«¯ç»™æœåŠ¡ç«¯å‘é€æ¶ˆæ¯äº†</span></span><br><span class="line">                msg = s.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Linuxå¹³å°ä¸‹çš„å¤„ç†</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> msg:</span><br><span class="line">                    <span class="keyword">raise</span> Exception(<span class="string">'å®¢æˆ·ç«¯å·²æ–­å¼€è¿æ¥'</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    outputs.append(s)</span><br><span class="line">                    print(msg)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># å‘å®¢æˆ·ç«¯å›å¤æ¶ˆæ¯</span></span><br><span class="line">                <span class="comment"># è¿™ç§å†™æ³•æ˜¯å®Œå…¨å¯ä»¥çš„,ä½†æ˜¯ç¼ºç‚¹æ˜¯è¯»å†™éƒ½æ··åœ¨äº†ä¸€èµ·</span></span><br><span class="line">                <span class="comment"># s.sendall(msg)</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">                <span class="comment"># Windowså¹³å°ä¸‹çš„å¤„ç†</span></span><br><span class="line">                inputs.remove(s)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éå†wList(éå†ç»™æœåŠ¡ç«¯å‘é€è¿‡æ¶ˆæ¯çš„å®¢æˆ·ç«¯)</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> wList:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç»™æ‰€æœ‰çš„å®¢æˆ·ç«¯ç»Ÿä¸€å›å¤å†…å®¹</span></span><br><span class="line">        s.sendall(bytes(<span class="string">'server response'</span>, encoding=<span class="string">'utf8'</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å›å¤å®Œæˆå,ä¸€å®šè¦å°†outputsä¸­è¯¥socketå¯¹è±¡ç§»é™¤</span></span><br><span class="line">        outputs.remove(s)</span><br></pre></td></tr></table></figure>

<p>wList = æ‰€æœ‰ç»™æœåŠ¡ç«¯å‘é€æ¶ˆæ¯çš„å®¢æˆ·ç«¯ï¼Œä¹Ÿæ˜¯éœ€è¦å›å¤æ¶ˆæ¯å®¢æˆ·ç«¯åˆ—è¡¨</p>
<ul>
<li><font color="blue">client.py</font> </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.connect((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line"><span class="comment"># æ¥æ”¶æ¬¢è¿æ¶ˆæ¯</span></span><br><span class="line">data = sk.recv(<span class="number">1024</span>)</span><br><span class="line">print(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = input(<span class="string">"&gt; "</span>)</span><br><span class="line">    <span class="comment"># å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯</span></span><br><span class="line">    sk.sendall(bytes(i, encoding=<span class="string">'utf8'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ¥æ”¶æœåŠ¡ç«¯å‘æ¥çš„æ¶ˆæ¯</span></span><br><span class="line">    msg = sk.recv(<span class="number">1024</span>)</span><br><span class="line">    print(str(msg, encoding=<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">sk.close()</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œè¿‡ç¨‹ï¼š</p>
<ul>
<li>ä¾æ¬¡è¿æ¥ä¸‰ä¸ªå®¢æˆ·ç«¯</li>
<li>ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯ä¾æ¬¡å‘æœåŠ¡å‘é€äº†ä¸¤æ¬¡æ¶ˆæ¯</li>
</ul>
<p>æœåŠ¡ç«¯çš„å›æ˜¾ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 2  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 2  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">b&#39;ps&#39;</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 1  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 1</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">b&#39;ps&#39;</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 1  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 1</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 4  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 3  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 2  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 2  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 1</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt; 1  | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt; 0</span><br><span class="line">selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt; 0  | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt; 0</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯çš„å›æ˜¾ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b&#39;hello&#39;</span><br><span class="line">&gt; ps</span><br><span class="line">server response</span><br><span class="line">&gt; ps</span><br><span class="line">server response</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç å®ç°äº†ç®€å•çš„æ”¶å‘æ¶ˆæ¯çš„åˆ†ç¦»ï¼Œç°åœ¨åˆå¤šäº†ä¸€ç‚¹éœ€æ±‚ï¼Œç›®å‰æ‰€æœ‰ç»™æœåŠ¡ç«¯å‘é€æ¶ˆæ¯çš„å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯éƒ½ç»Ÿä¸€å›å¤äº†ç›¸åŒçš„å†…å®¹ï¼Œç°åœ¨è¦æœåŠ¡ç«¯å®ç°Echo Serverçš„åŠŸèƒ½ï¼Œå³å®¢æˆ·ç«¯å‘é€ä»€ä¹ˆæ¶ˆæ¯ï¼ŒæœåŠ¡ç«¯å°±ç»™å®¢æˆ·ç«¯å›å¤ä»€ä¹ˆæ¶ˆæ¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºsocketå¯¹è±¡,ç»‘å®šIPç«¯å£,ç›‘å¬</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((<span class="string">'127.0.0.1'</span>, <span class="number">1559</span>))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">inputs = [sk]</span><br><span class="line">outputs = []</span><br><span class="line">messages = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">messages = &#123;</span></span><br><span class="line"><span class="string">    socket_obj1: [msg]</span></span><br><span class="line"><span class="string">    socket_obj2: [msg]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    rList, wList, e = select.select(inputs, outputs, [], <span class="number">1</span>)</span><br><span class="line">    print(<span class="string">"---"</span> * <span class="number">20</span>)</span><br><span class="line">    print(<span class="string">"selectå½“å‰ç›‘å¬inputså¯¹è±¡çš„æ•°é‡&gt;"</span>, len(inputs), <span class="string">" | å‘ç”Ÿå˜åŒ–çš„socketæ•°é‡&gt;"</span>, len(rList))</span><br><span class="line">    print(<span class="string">"selectå½“å‰ç›‘å¬outputså¯¹è±¡çš„æ•°é‡&gt;"</span>, len(outputs), <span class="string">" | éœ€è¦å›å¤å®¢æˆ·ç«¯æ¶ˆæ¯çš„æ•°é‡&gt;"</span>, len(wList))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éå†rList(å»ºç«‹è¿æ¥å’Œæ¥æ”¶æ•°æ®)</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> rList:</span><br><span class="line">        <span class="comment"># åˆ¤æ–­socketå¯¹è±¡å¦‚æœæ˜¯æœåŠ¡ç«¯çš„socketå¯¹è±¡çš„è¯</span></span><br><span class="line">        <span class="keyword">if</span> s == sk:</span><br><span class="line">            conn, address = s.accept()</span><br><span class="line">            <span class="comment"># connä¹Ÿæ˜¯ä¸€ä¸ªsocketå¯¹è±¡</span></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯socketæ¥æ”¶åˆ°å®¢æˆ·çš„è¯·æ±‚å,ä¼šåˆ†é…ä¸€ä¸ªæ–°çš„socketå¯¹è±¡ä¸“é—¨ç”¨æ¥å’Œè¿™ä¸ªå®¢æˆ·ç«¯è¿›è¡Œè¿æ¥é€šä¿¡</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># å½“æœåŠ¡ç«¯åˆ†é…æ–°çš„socketå¯¹è±¡ç»™æ–°è¿æ¥è¿›æ¥çš„å®¢æˆ·ç«¯çš„æ—¶å€™</span></span><br><span class="line">            <span class="comment"># æˆ‘ä»¬ä¹Ÿéœ€è¦ç›‘å¬è¿™ä¸ªå®¢æˆ·ç«¯çš„socketå¯¹è±¡æ˜¯å¦ä¼šå‘ç”Ÿå˜åŒ–</span></span><br><span class="line">            <span class="comment"># ä¸€æ—¦å‘ç”Ÿå˜åŒ–,æ„å‘³ç€å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘æ¥äº†æ¶ˆæ¯</span></span><br><span class="line">            inputs.append(conn)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># åœ¨messagesä¸­ä¸ºè¯¥å¯¹è±¡åˆ›å»ºkey</span></span><br><span class="line">            messages[conn] = []</span><br><span class="line"></span><br><span class="line">            conn.sendall(bytes(<span class="string">'hello'</span>, encoding=<span class="string">'utf8'</span>))</span><br><span class="line">        <span class="comment"># å…¶ä»–çš„å°±éƒ½æ˜¯å®¢æˆ·ç«¯çš„socketå¯¹è±¡äº†</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># æ„å‘³ç€å®¢æˆ·ç«¯ç»™æœåŠ¡ç«¯å‘é€æ¶ˆæ¯äº†</span></span><br><span class="line">                msg = s.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Linuxå¹³å°ä¸‹çš„å¤„ç†</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> msg:</span><br><span class="line">                    <span class="keyword">raise</span> Exception(<span class="string">'å®¢æˆ·ç«¯å·²æ–­å¼€è¿æ¥'</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    outputs.append(s)</span><br><span class="line">                    messages[s].append(msg)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># å‘å®¢æˆ·ç«¯å›å¤æ¶ˆæ¯</span></span><br><span class="line">                <span class="comment"># è¿™ç§å†™æ³•æ˜¯å®Œå…¨å¯ä»¥çš„,ä½†æ˜¯ç¼ºç‚¹æ˜¯è¯»å†™éƒ½æ··åœ¨äº†ä¸€èµ·</span></span><br><span class="line">                <span class="comment"># s.sendall(msg)</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">                <span class="comment"># Windowså¹³å°ä¸‹çš„å¤„ç†</span></span><br><span class="line">                inputs.remove(s)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># åœ¨å®¢æˆ·ç«¯æ–­å¼€è¿æ¥å,ç›¸å¯¹åº”çš„è¯¥å®¢æˆ·ç«¯çš„messagesä¸­çš„ä¿¡æ¯ä¹Ÿéœ€è¦åˆ é™¤</span></span><br><span class="line">                <span class="keyword">del</span> messages[s]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éå†wList(éå†ç»™æœåŠ¡ç«¯å‘é€è¿‡æ¶ˆæ¯çš„å®¢æˆ·ç«¯)</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> wList:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åœ¨è¯¥å®¢æˆ·ç«¯è¿æ¥å¯¹è±¡çš„messagesä¿¡æ¯ä¸­å–å‡ºä¸€ä¸ªè¿›è¡Œå›å¤</span></span><br><span class="line">        msg = messages[s].pop()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ ¹æ®å®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯è¿›è¡Œå›å¤</span></span><br><span class="line">        s.sendall(msg)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å›å¤å®Œæˆå,ä¸€å®šè¦å°†outputsä¸­è¯¥socketå¯¹è±¡ç§»é™¤</span></span><br><span class="line">        outputs.remove(s)</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡ç«¯åšå‡ºä»¥ä¸Šä¿®æ”¹ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦æ”¹å˜</p>
<ul>
<li>11è¡Œ ä¸ºäº†è®©ä¸€ä¸ªå®¢æˆ·ç«¯socketå¯¹è±¡æ”¶æ¶ˆæ¯å’Œå‘æ¶ˆæ¯äº§ç”Ÿå…³è”ï¼Œå¼•å…¥äº†ä¸€ä¸ªæ–°çš„å…¨å±€å˜é‡messages</li>
<li>40è¡Œ åœ¨æ–°å®¢æˆ·ç«¯è¿æ¥è¿›æ¥çš„æ—¶å€™ï¼Œå°±é¢„å…ˆä¸ºè¯¥socketå¯¹è±¡åœ¨messagesä¸­åˆ›å»ºå¯¹åº”çš„key</li>
<li>54è¡Œ åœ¨è¯¥å¯¹è±¡ä¸­æ·»åŠ æ¶ˆæ¯</li>
<li>64è¡Œ åœ¨å®¢æˆ·ç«¯å…³é—­è¿æ¥æ”¶ï¼Œæ¸…ç†è¯¥å¯¹è±¡çš„æ¶ˆæ¯åˆ—è¡¨</li>
<li>70è¡Œ å°†è¯¥å¯¹è±¡åœ¨ç¬¬40è¡Œæ’å…¥çš„æ¶ˆæ¯ä¸­å–å‡ºæ¥</li>
</ul>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä½¿ç”¨IOå¤šè·¯å¤ç”¨ï¼Œå®é™…ä¸Šå®ç°äº†ç±»ä¼¼å¹¶å‘æ•ˆæœçš„ä¼ªå¹¶å‘ã€‚å†…éƒ¨å®é™…ä½¿ç”¨äº†å¾ªç¯æ¥é«˜æ•ˆçš„å¤„ç†é˜»å¡è¯·æ±‚</p>
<p>Pythonä¸­æœ‰ä¸€ä¸ªselectæ¨¡å—ï¼Œå…¶ä¸­æä¾›äº†ï¼šselectã€pollã€epollä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«è°ƒç”¨ç³»ç»Ÿçš„ selectï¼Œpollï¼Œepoll ä»è€Œå®ç°IOå¤šè·¯å¤ç”¨ã€‚</p>
<ul>
<li>Windows Pythonï¼šæä¾›ï¼š select</li>
<li>Mac Pythonï¼šæä¾›ï¼š select</li>
<li>Linux Pythonï¼šæä¾›ï¼š selectã€pollã€epoll</li>
</ul>
<p>æ³¨æ„ï¼šç½‘ç»œæ“ä½œã€æ–‡ä»¶æ“ä½œã€ç»ˆç«¯æ“ä½œç­‰å‡å±äºIOæ“ä½œï¼Œå¯¹äºwindowsåªæ”¯æŒSocketæ“ä½œï¼Œå…¶ä»–ç³»ç»Ÿæ”¯æŒæ‰€æœ‰IOæ“ä½œï¼Œä½†æ˜¯æ— æ³•æ£€æµ‹æ™®é€šæ–‡ä»¶æ“ä½œè‡ªåŠ¨ä¸Šæ¬¡è¯»å–æ˜¯å¦å·²ç»å˜åŒ–</p>
<p>å¯¹äºselectæ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">å¥æŸ„åˆ—è¡¨11, å¥æŸ„åˆ—è¡¨22, å¥æŸ„åˆ—è¡¨33 &#x3D; select.select(å¥æŸ„åºåˆ—1, å¥æŸ„åºåˆ—2, å¥æŸ„åºåˆ—3, è¶…æ—¶æ—¶é—´)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">å‚æ•°ï¼š å¯æ¥å—å››ä¸ªå‚æ•°ï¼ˆå‰ä¸‰ä¸ªå¿…é¡»ï¼‰</span><br><span class="line">è¿”å›å€¼ï¼šä¸‰ä¸ªåˆ—è¡¨</span><br><span class="line"> </span><br><span class="line">selectæ–¹æ³•ç”¨æ¥ç›‘è§†æ–‡ä»¶å¥æŸ„ï¼Œå¦‚æœå¥æŸ„å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è·å–è¯¥å¥æŸ„ã€‚</span><br><span class="line">1ã€å½“ å‚æ•°1 åºåˆ—ä¸­çš„å¥æŸ„å‘ç”Ÿå¯è¯»æ—¶ï¼ˆaccetpå’Œreadï¼‰ï¼Œåˆ™è·å–å‘ç”Ÿå˜åŒ–çš„å¥æŸ„å¹¶æ·»åŠ åˆ° è¿”å›å€¼1 åºåˆ—ä¸­</span><br><span class="line">2ã€å½“ å‚æ•°2 åºåˆ—ä¸­å«æœ‰å¥æŸ„æ—¶ï¼Œåˆ™å°†è¯¥åºåˆ—ä¸­æ‰€æœ‰çš„å¥æŸ„æ·»åŠ åˆ° è¿”å›å€¼2 åºåˆ—ä¸­</span><br><span class="line">3ã€å½“ å‚æ•°3 åºåˆ—ä¸­çš„å¥æŸ„å‘ç”Ÿé”™è¯¯æ—¶ï¼Œåˆ™å°†è¯¥å‘ç”Ÿé”™è¯¯çš„å¥æŸ„æ·»åŠ åˆ° è¿”å›å€¼3 åºåˆ—ä¸­</span><br><span class="line">4ã€å½“ è¶…æ—¶æ—¶é—´ æœªè®¾ç½®ï¼Œåˆ™selectä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°ç›‘å¬çš„å¥æŸ„å‘ç”Ÿå˜åŒ–</span><br><span class="line">   å½“ è¶…æ—¶æ—¶é—´ ï¼ 1æ—¶ï¼Œé‚£ä¹ˆå¦‚æœç›‘å¬çš„å¥æŸ„å‡æ— ä»»ä½•å˜åŒ–ï¼Œåˆ™selectä¼šé˜»å¡ 1 ç§’ï¼Œä¹‹åè¿”å›ä¸‰ä¸ªç©ºåˆ—è¡¨ï¼Œå¦‚æœç›‘å¬çš„å¥æŸ„æœ‰å˜åŒ–ï¼Œåˆ™ç›´æ¥æ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure>

<h1 id="é™„åŠ ï¼šselect-poll-epollçš„åŒºåˆ«"><a href="#é™„åŠ ï¼šselect-poll-epollçš„åŒºåˆ«" class="headerlink" title="é™„åŠ ï¼šselect poll epollçš„åŒºåˆ«"></a>é™„åŠ ï¼šselect poll epollçš„åŒºåˆ«</h1><p>IOå¤šè·¯å¤ç”¨æ˜¯ç³»ç»Ÿå†…æ ¸å®ç°çš„ï¼Œç³»ç»Ÿå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªforå¾ªç¯ï¼Œä¸€ä¸ªä¸€ä¸ªåœ°å»æ£€æµ‹å¯¹è±¡æ˜¯å¦æœ‰å˜åŒ–</p>
<p>é¦–å…ˆéœ€è¦æ˜ç¡®ä¸€ç‚¹çš„æ˜¯ï¼Œforå¾ªç¯çš„æ•ˆç‡æ˜¯ä¸é«˜çš„</p>
<table>
<thead>
<tr>
<th>IOå¤šè·¯å¤ç”¨ç§ç±»</th>
<th>å®ç°åŸç†</th>
<th>ç›‘å¬å¯¹è±¡ä¸ªæ•°</th>
</tr>
</thead>
<tbody><tr>
<td>select</td>
<td>ç³»ç»Ÿå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªforå¾ªç¯</td>
<td>1024</td>
</tr>
<tr>
<td>poll</td>
<td>ç³»ç»Ÿå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªforå¾ªç¯</td>
<td>æ²¡æœ‰é™åˆ¶</td>
</tr>
<tr>
<td>epoll</td>
<td>å¥æŸ„åºåˆ—å‘ç”Ÿå˜åŒ–æ—¶è‡ªåŠ¨é€šçŸ¥epoll</td>
<td>æ²¡æœ‰é™åˆ¶</td>
</tr>
</tbody></table>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/12/Python2-7%E4%B8%8EPython3-5%E7%BB%A7%E6%89%BF%E7%9A%84%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/12/Python2-7%E4%B8%8EPython3-5%E7%BB%A7%E6%89%BF%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">Python2.7ä¸Python3.5ç»§æ‰¿çš„åŒºåˆ«</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-12 03:24:52" itemprop="dateCreated datePublished" datetime="2016-07-12T03:24:52+08:00">2016-07-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/12/Python2-7%E4%B8%8EPython3-5%E7%BB%A7%E6%89%BF%E7%9A%84%E5%8C%BA%E5%88%AB/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/12/Python2-7ä¸Python3-5ç»§æ‰¿çš„åŒºåˆ«/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>Pythonä¸­2.7ä¸3.5çš„ç»§æ‰¿ç•¥æœ‰åŒºåˆ«ï¼Œ åœ¨Python2.7ä¸­çš„ç±»å¯ä»¥åˆ†ä¸ºç»å…¸ç±»ï¼ˆé»˜è®¤å°±æ˜¯ç»å…¸ç±»ï¼‰å’Œæ–°å¼ç±»ï¼ˆç»§æ‰¿äº†objectç±»çš„å°±æ˜¯æ–°å¼ç±»ï¼‰ï¼Œè€Œåœ¨Python3.5ä¸­ï¼Œæ‰€æœ‰çš„ç±»é»˜è®¤ç»§æ‰¿objectç±»</p>
</blockquote>
<p><img src="http://oss.20150509.cn/20160712033359.png" alt=""></p>
<ul>
<li><p>Python2.7çš„ç±»å¦‚æœç»§æ‰¿äº†objectç±»ï¼Œé‚£ä¹ˆå¤šç»§æ‰¿å‘ä¸Šå¯»æ‰¾çš„è·¯å¾„å’ŒPython3.5æ˜¯ä¸€æ ·çš„ï¼Œå›¾ä¸­æ©™è‰²çš„å¯»æ‰¾è·¯å¾„</p>
</li>
<li><p>ä½†æ˜¯å¦‚æœPython2.7æ²¡æœ‰ç»§æ‰¿objectç±»ï¼Œé‚£ä¹ˆå°±æ˜¯å›¾ä¸­è“è‰²çš„å¯»æ‰¾è·¯å¾„</p>
</li>
</ul>
<p>æ›´å¤šå…³äºç»§æ‰¿çš„å†…å®¹å¯ä»¥å‚è€ƒä»¥ä¸‹æ–‡ç« ï¼š</p>
<p><a href="http://docs.20150509.cn/2016/06/28/Pythoné¢å‘å¯¹è±¡åŸºç¡€ç¯‡ä¹‹ç»§æ‰¿/" target="_blank" rel="noopener">http://docs.20150509.cn/2016/06/28/Pythoné¢å‘å¯¹è±¡åŸºç¡€ç¯‡ä¹‹ç»§æ‰¿/</a></p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://docs.lvrui.io/2016/07/12/Python%E7%9A%84%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.JPG">
      <meta itemprop="name" content="æåœ°ç‘é›ª">
      <meta itemprop="description" content="æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Polar Snow Documentation">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/12/Python%E7%9A%84%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F/" class="post-title-link" itemprop="url">Pythonçš„å˜é‡ä½œç”¨åŸŸ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2016-07-12 01:13:36" itemprop="dateCreated datePublished" datetime="2016-07-12T01:13:36+08:00">2016-07-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/2016/07/12/Python%E7%9A%84%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/12/Pythonçš„å˜é‡ä½œç”¨åŸŸ/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>Pythonçš„å˜é‡ä½œç”¨åŸŸä¸­åˆ†ä¸ºå››ä¸ªçº§åˆ«ï¼Œç®€ç§°ä¸ºï¼šBGELï¼Œä½œç”¨åŸŸçš„çº§åˆ«ä¾æ¬¡å‡é«˜ï¼Œçº§åˆ«æœ€é«˜çš„æ˜¯Localï¼Œå¦‚æœè¯¥å˜é‡åœ¨Localä¸­å·²ç»å£°æ˜å¹¶èµ‹å€¼ï¼Œå°†ä¼˜å…ˆä½¿ç”¨Localä¸­çš„å˜é‡å¯¹åº”çš„å€¼</p>
</blockquote>
<p>Pythonå˜é‡ä½œç”¨åŸŸçš„å››ç§æƒ…å†µï¼š</p>
<ul>
<li>Bï¼šbuild-in ç³»ç»Ÿå›ºå®šæ¨¡å—é‡Œé¢çš„å˜é‡ï¼Œä¹Ÿå«ç³»ç»Ÿå˜é‡ï¼Œæ¯”å¦‚int</li>
<li>Gï¼šglobal å…¨å±€å˜é‡ï¼Œä¹Ÿå°±æ˜¯æ¨¡å—çº§åˆ«å®šä¹‰çš„å˜é‡</li>
<li>Eï¼šenclosing åµŒå¥—çš„çˆ¶çº§å‡½æ•°çš„å±€éƒ¨ä½œç”¨åŸŸï¼Œå°±æ˜¯åŒ…å«æ­¤å‡½æ•°çš„ä¸Šå±‚å‡½æ•°çš„å±€éƒ¨ä½œç”¨åŸŸ</li>
<li>Lï¼šlocal å±€éƒ¨ä½œç”¨åŸŸï¼Œå³ä¸ºå‡½æ•°ä¸­å®šä¹‰çš„å˜é‡</li>
</ul>
<p><em>Eå’ŒLæ˜¯ç›¸å¯¹çš„ï¼ŒEä¸­çš„å˜é‡ç›¸å¯¹ä¸Šå±‚æ¥è¯´ä¹Ÿæ˜¯L</em></p>
<p>Pythonçš„å˜é‡ä½œç”¨åŸŸå¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š</p>
<p><img src="http://oss.20150509.cn/20160712012859.png" alt=""></p>
<p>ä¸€ä¸ªå˜é‡ä½¿ç”¨å“ªä¸ªåŸŸä¸­å®šä¹‰çš„å€¼ï¼Œå–å†³äºå®ƒçš„ç›¸å¯¹ä½ç½®</p>
<p>ä»ä¸Šå›¾ä¸­çœ‹ï¼Œå¦‚æœä»Localçš„ä½ç½®å‘ä¸Šçœ‹ï¼Œæœ€å…ˆçœ‹åˆ°çš„æ˜¯Localä¸­çš„å˜é‡ï¼Œå…¶æ¬¡æ˜¯Enclosingä¸­çš„å˜é‡ï¼Œå†æ¬¡æ˜¯Globalä¸­çš„å˜é‡ï¼Œæœ€åæ‰æ˜¯Build-inå˜é‡</p>
<p>å˜é‡çš„å–å€¼å–å†³äºä½ åœ¨å“ªä¸ªä½ç½®ï¼Œæ¯”å¦‚ä½ åœ¨Eå’ŒLä¸­é—´ï¼Œé‚£åŒåçš„è¿™ä¸ªå˜é‡è‚¯å®šæ˜¯ä¼šå‘å‰çœ‹ï¼Œå–Eä¸­çš„å€¼</p>
<h1 id="Pythonä½œç”¨åŸŸçš„äº§ç”Ÿ"><a href="#Pythonä½œç”¨åŸŸçš„äº§ç”Ÿ" class="headerlink" title="Pythonä½œç”¨åŸŸçš„äº§ç”Ÿ"></a>Pythonä½œç”¨åŸŸçš„äº§ç”Ÿ</h1><p>åœ¨Pythonä¸­ï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸã€‚åªæœ‰æ¨¡å—(module)ï¼Œç±»(class)ä»¥åŠå‡½æ•°(def,lambda)æ‰ä¼šå¼•å…¥æ–°çš„ä½œç”¨åŸŸ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">    name = <span class="string">"PolarSnow"</span></span><br><span class="line">    </span><br><span class="line">print(name)</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼Œä½†æ˜¯åœ¨Java(æœ‰å—çº§ä½œç”¨åŸŸ)ä¸­è¿è¡Œå°±ä¼šæŠ¥ï¼Œå˜é‡æœªå®šä¹‰çš„é”™è¯¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">    name = <span class="string">"Polarsnow"</span></span><br><span class="line">  </span><br><span class="line">func()  </span><br><span class="line">print(name)</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç æ‰§è¡Œå°±ä¼šæŠ¥é”™ï¼Œnameå˜é‡æœªå®šä¹‰</p>
<h1 id="Pythonå˜é‡ä½œç”¨åŸŸ"><a href="#Pythonå˜é‡ä½œç”¨åŸŸ" class="headerlink" title="Pythonå˜é‡ä½œç”¨åŸŸ"></a>Pythonå˜é‡ä½œç”¨åŸŸ</h1><h2 id="L-Local"><a href="#L-Local" class="headerlink" title="L(Local)"></a>L(Local)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">int = <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">()</span>:</span></span><br><span class="line">    int = <span class="number">6</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">        int = <span class="number">5</span></span><br><span class="line">        print(int)</span><br><span class="line">    <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line">f = func2()</span><br><span class="line">f()</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>

<p>LEGéƒ½å¯¹intå˜é‡è‡ªå®šä¹‰äº†å€¼ï¼Œä½†æ˜¯æœ€åå–å¾—æ˜¯Lä¸­çš„å€¼</p>
<h2 id="E-Enclosing"><a href="#E-Enclosing" class="headerlink" title="E(Enclosing)"></a>E(Enclosing)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">int = <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">()</span>:</span></span><br><span class="line">    int = <span class="number">6</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">        print(int)</span><br><span class="line">    <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line">f = func2()</span><br><span class="line">f()</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure>

<p>åœ¨localä¸­å–å€¼ï¼Œä½†æ˜¯localä¸­æ²¡æœ‰ï¼Œå°±ä¼šå»Eé‡Œé¢æ‰¾</p>
<h2 id="G-Global"><a href="#G-Global" class="headerlink" title="G(Global)"></a>G(Global)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int = <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">        print(int)</span><br><span class="line">    <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line">f = func2()</span><br><span class="line">f()</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line"><span class="number">7</span></span><br></pre></td></tr></table></figure>

<p>Lå’ŒEä¸­éƒ½æ²¡æœ‰æ‰¾åˆ°intçš„å€¼ï¼Œç»§ç»­å‘ä¸Šæ‰¾ï¼Œåœ¨Gä¸­æ‰¾åˆ°äº†intçš„å€¼</p>
<h2 id="B-Build-in"><a href="#B-Build-in" class="headerlink" title="B(Build-in)"></a>B(Build-in)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">        print(int)</span><br><span class="line">    <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line">f = func2()</span><br><span class="line">f()</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">int</span>'&gt;</span></span><br></pre></td></tr></table></figure>

<p>intå˜é‡çš„å€¼åœ¨LEGä¸­éƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œä½†æ˜¯intæ˜¯å†…å»ºå˜é‡ï¼Œåœ¨ç³»ç»Ÿä¸­å·²ç»å¯¹å…¶æœ‰å®šä¹‰ï¼Œæœ€ååœ¨Bä¸­ï¼Œæ‰¾åˆ°äº†intçš„å€¼</p>
<p>å¦‚æœä¸€ä¸ªå˜é‡åœ¨localä¸­æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾åˆ°Bä¸­è¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä¼šæŠ¥å˜é‡æœªå®šä¹‰çš„é”™è¯¯</p>
<h1 id="global-amp-nonlocal-å…³é”®å­—"><a href="#global-amp-nonlocal-å…³é”®å­—" class="headerlink" title="global &amp; nonlocal å…³é”®å­—"></a>global &amp; nonlocal å…³é”®å­—</h1><h2 id="global"><a href="#global" class="headerlink" title="global"></a>global</h2><p>å‡½æ•°å†…éƒ¨å¯ä»¥è®¿é—®å…¨å±€å˜é‡ä¸­çš„å€¼ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹å…¨å±€å˜é‡çš„å€¼ã€‚å¦‚æœéœ€è¦ä¿®æ”¹ï¼Œè¦åŠ ä¸Šglobalå…³é”®å­—</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">"ps"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">readonly</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"inner ---&gt;"</span>, name)</span><br><span class="line"></span><br><span class="line">readonly()</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">ps</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°å†…éƒ¨æ˜¯å¯ä»¥è®¿é—®å…¨å±€å˜é‡çš„å€¼çš„ï¼ŒåŸåˆ™ â€“&gt; GBEL</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">"ps"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">readonly</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> name</span><br><span class="line">    name = <span class="string">"PolarSnow"</span></span><br><span class="line"></span><br><span class="line">readonly()</span><br><span class="line">print(name)</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">PolarSnow</span><br></pre></td></tr></table></figure>

<p>åŠ ä¸Šäº†globalå…³é”®å­—ï¼Œå°±å¯ä»¥ä¿®æ”¹å…¨å±€å˜é‡çš„å€¼</p>
<h2 id="nonlocal"><a href="#nonlocal" class="headerlink" title="nonlocal"></a>nonlocal</h2><p>globalå…³é”®å­—å£°æ˜çš„å˜é‡å¿…é¡»åœ¨å…¨å±€ä½œç”¨åŸŸä¸Šï¼Œä¸èƒ½åµŒå¥—ä½œç”¨åŸŸä¸Šï¼Œå½“è¦ä¿®æ”¹åµŒå¥—ä½œç”¨åŸŸï¼ˆenclosingä½œç”¨åŸŸï¼Œå¤–å±‚éå…¨å±€ä½œç”¨åŸŸï¼‰ä¸­çš„å˜é‡å°±éœ€è¦nonlocalå…³é”®å­—äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span><span class="params">()</span>:</span></span><br><span class="line">    count = <span class="number">10</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> count</span><br><span class="line">        count = <span class="number">20</span></span><br><span class="line">        print(<span class="string">"inner ---&gt; "</span>, count)</span><br><span class="line">    inner()</span><br><span class="line">    print(<span class="string">"outer ---&gt;"</span>, count)</span><br><span class="line"></span><br><span class="line">outer()</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line"><span class="number">20</span></span><br><span class="line"><span class="number">20</span></span><br></pre></td></tr></table></figure>


<h1 id="å˜é‡ä½œç”¨åŸŸä¸­çš„ç–‘éš¾æ‚ç—‡"><a href="#å˜é‡ä½œç”¨åŸŸä¸­çš„ç–‘éš¾æ‚ç—‡" class="headerlink" title="å˜é‡ä½œç”¨åŸŸä¸­çš„ç–‘éš¾æ‚ç—‡"></a>å˜é‡ä½œç”¨åŸŸä¸­çš„ç–‘éš¾æ‚ç—‡</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">"123"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span><span class="params">()</span>:</span></span><br><span class="line">    print(name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">()</span>:</span></span><br><span class="line">    name = <span class="string">"456"</span></span><br><span class="line">    func1()</span><br><span class="line"></span><br><span class="line">func2()</span><br></pre></td></tr></table></figure>

<p>æœ€åä¼šè¾“å‡ºä»€ä¹ˆç»“æœï¼Ÿ</p>
<p>ç»“æœæ˜¯ï¼š <code>123</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">"123"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span><span class="params">()</span>:</span></span><br><span class="line">    print(name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">()</span>:</span></span><br><span class="line">    name = <span class="string">"456"</span></span><br><span class="line">    <span class="keyword">return</span> func1</span><br><span class="line"></span><br><span class="line">ret = func2()</span><br><span class="line">ret()</span><br></pre></td></tr></table></figure>

<p>ç»“æœæ˜¯ï¼š <code>123</code></p>
<p>ä¸Šé¢ä¸¤æ®µä»£ç çš„ç»“æœéƒ½æ˜¯å…¨å±€å˜é‡ä¸­çš„å€¼<code>123</code>ï¼Œè¿™é‡Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œå˜é‡ä½œç”¨åŸŸåœ¨å‡½æ•°æ‰§è¡Œä¹‹å‰å°±å·²ç»ç¡®å®šäº†ï¼</p>
<p>Pythonä½œä¸ºè§£é‡Šå‹çš„è¯­è¨€ï¼Œä»£ç ä»ä¸Šè‡³ä¸‹æ‰§è¡Œï¼Œé‡åˆ°defæ—¶ï¼Œå°±å°†å…¶å‡½æ•°ä½“ä¿å­˜åœ¨å†…å­˜çš„å †åŒºï¼ŒæŠŠå¯¹åº”çš„å‡½æ•°åä¿å­˜åœ¨æ ˆåŒºå¹¶æŒ‡å‘å †åŒºçš„å‡½æ•°ä½“ï¼Œåœ¨å‡½æ•°æ‰§è¡Œä¹‹å‰ï¼Œè¿™ä¸ªå‡½æ•°ä¸­çš„å˜é‡ä½œç”¨åŸŸå°±å·²ç»è¢«è®°å½•åˆ°å†…å­˜ä¸­äº†ï¼Œä¸ä¼šå› ä¸ºåæœŸçš„è°ƒç”¨æˆ–åµŒå¥—è€Œæ›´æ”¹</p>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">l = [x + <span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>) <span class="keyword">if</span> x &gt; <span class="number">5</span>]</span><br><span class="line">print(<span class="string">"display list ---&gt;"</span>, l)</span><br><span class="line">print(<span class="string">"first element ---&gt;"</span>, l[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">"---"</span> * <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">ll = [<span class="keyword">lambda</span> :x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>) <span class="keyword">if</span> x &gt; <span class="number">5</span>]</span><br><span class="line">print(<span class="string">"display list ---&gt;"</span>, ll)</span><br><span class="line"></span><br><span class="line">ret = ll[<span class="number">0</span>]()</span><br><span class="line">print(<span class="string">"first element ---&gt;"</span>, ret)</span><br></pre></td></tr></table></figure>

<p>ç»“æœæ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">display list ---&gt; [7, 8, 9, 10]</span><br><span class="line">first element ---&gt; 7</span><br><span class="line">---------------</span><br><span class="line">display list ---&gt; [&lt;function &lt;listcomp&gt;.&lt;lambda&gt; at 0x101b7b730&gt;, &lt;function &lt;listcomp&gt;.&lt;lambda&gt; at 0x101b7b7b8&gt;, &lt;function &lt;listcomp&gt;.&lt;lambda&gt; at 0x101b7b840&gt;, &lt;function &lt;listcomp&gt;.&lt;lambda&gt; at 0x101b7b8c8&gt;]</span><br><span class="line">first element ---&gt; 9</span><br></pre></td></tr></table></figure>

<p>é—®é¢˜æ¥äº†ï¼Œé—®ä»€ä¹ˆä½¿ç”¨äº†lambdaä¹‹åï¼Œç¬¬ä¸€ä¸ªå…ƒç´ å˜æˆ9äº†å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æŠŠè¿™ä¸ªé—®é¢˜æ‹†è§£ä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">lll = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">5</span>:</span><br><span class="line">        lll.append(x + <span class="number">1</span>)</span><br><span class="line">print(lll)</span><br><span class="line">print(lll[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">llll = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">5</span>:</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        llll.append(func)</span><br><span class="line">print(llll)</span><br><span class="line">print(llll[<span class="number">0</span>]())</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">[<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="number">7</span></span><br><span class="line">[&lt;function func at <span class="number">0x10137b620</span>&gt;, &lt;function func at <span class="number">0x10137b6a8</span>&gt;, &lt;function func at <span class="number">0x10137b730</span>&gt;, &lt;function func at <span class="number">0x10137b7b8</span>&gt;]</span><br><span class="line"><span class="number">9</span></span><br></pre></td></tr></table></figure>

<p>ä¸ºä»€ä¹ˆ x+1 æ—¶ç¬¬ä¸€ä¸ªå…ƒç´  = 7ï¼Œ è€Œ lambda :x æ—¶ç¬¬ä¸€ä¸ªå…ƒç´  = 9äº†å‘¢</p>
<p>åŸå› å°±æ˜¯Pythonç¨‹åºåœ¨è§£é‡Šé“lambdaçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œé‡Œé¢çš„ä»£ç ï¼Œè€Œæ˜¯ç›´æ¥æ”¾åˆ°çš„äº†å†…å­˜ä¸­ï¼Œéšç€å¤–ä¾§å¾ªç¯çš„ç»“æŸï¼Œxçš„å€¼å·²ç»å˜æˆäº†9ï¼Œæ­¤æ—¶å†æŠŠå†…å­˜é‡Œä¿å­˜çš„lambdaå‡½æ•°æ‹¿å‡ºæ¥æ‰§è¡Œï¼Œxå˜é‡è·å–åˆ°çš„å°±æ˜¯å½“å‰å·²ç»å˜æˆ9çš„è¿™ä¸ªå€¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">lllll = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">5</span>:</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(i = x)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        lllll.append(func)</span><br><span class="line">print(lllll)</span><br><span class="line">print(lllll[<span class="number">0</span>]())</span><br><span class="line">print(lllll[<span class="number">1</span>]())</span><br><span class="line">print(lllll[<span class="number">2</span>]())</span><br><span class="line">print(lllll[<span class="number">3</span>]())</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">[&lt;function func at <span class="number">0x101b7b620</span>&gt;, &lt;function func at <span class="number">0x101b7b6a8</span>&gt;, &lt;function func at <span class="number">0x101b7b730</span>&gt;, &lt;function func at <span class="number">0x101b7b7b8</span>&gt;]</span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">9</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç ä»…ä»…å°ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œåœ¨funcä¸­æ‰§è¡Œä¸€æ¡èµ‹å€¼è¯­å¥ï¼Œç»“æœå°±ç«‹åˆ»ä¸ä¸€æ ·äº†ï¼Œè¿™æ¬¡åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå€¼å˜æˆäº†6</p>
<p>ä¹‹å‰ä¸æ˜¯è¯´ä»£ç è¿è¡Œåˆ°defå°±ç›´æ¥ä¿å­˜åˆ°å†…å­˜ï¼Œä¸æ‰§è¡Œäº†å—ï¼Ÿæ²¡é”™ï¼Œå‡½æ•°ä½“æ˜¯æ²¡æœ‰è¢«æ‰§è¡Œï¼Œä½†æ˜¯å‡½æ•°çš„å‚æ•°æ˜¯ä¸ªèµ‹å€¼è¡¨è¾¾å¼ï¼Œè¢«Pythonè§£é‡Šå™¨æ‰§è¡Œäº†ï¼Œè·å–åˆ°äº†æ¯ä¸ªå¾ªç¯çš„xçš„å€¼ï¼Œå¹¶èµ‹å€¼ç»™å‡½æ•°è‡ªå·±å†…éƒ¨çš„å˜é‡ï¼ˆlocalï¼‰</p>
<p>å½“ç¨‹åºæ‰§è¡Œå®Œæ¯•ï¼Œè¿è¡Œåˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå‡½æ•°å–å€¼çš„æ—¶å€™ï¼Œè¯¥å‡½æ•°å–åˆ°çš„æ˜¯å‡½æ•°å†…éƒ¨çš„å˜é‡iï¼Œæ‰€ä»¥æœ€åçš„ç»“æœå’Œä¸Šé¢æ˜¯æˆªç„¶ä¸åŒçš„</p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/20/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><span class="page-number current">21</span><a class="page-number" href="/page/22/">22</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><a class="extend next" rel="next" href="/page/22/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="æåœ°ç‘é›ª"
      src="/images/avatar.JPG">
  <p class="site-author-name" itemprop="name">æåœ°ç‘é›ª</p>
  <div class="site-description" itemprop="description">æåœ°ç‘é›ªçš„ä¸ªäººæŠ€æœ¯åšå®¢. "å–ä¹‹å¼€æº ç”¨ä¹‹å¼€æº", åˆ†äº«è‡ªå·±çš„ç»éªŒä¹‹è°ˆ".</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">284</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">372</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Larry0315" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Larry0315" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:polarsnow@lvrui.io" title="E-Mail â†’ mailto:polarsnow@lvrui.io" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.lvrui.io/" title="https:&#x2F;&#x2F;www.lvrui.io" rel="noopener" target="_blank">www.lvrui.io</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://20150509.cn/" title="https:&#x2F;&#x2F;20150509.cn" rel="noopener" target="_blank">20150509.cn</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">å†€ICPå¤‡15013857å·-2 </a>
  </div>

<div class="copyright">
  
  &copy; 2015 â€“ 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">æåœ°ç‘é›ª</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://polarsnow.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>

</body>
</html>
